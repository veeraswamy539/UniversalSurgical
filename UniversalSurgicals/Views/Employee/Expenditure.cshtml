@using Universal.BusinessEntities;
@model Employees
@Scripts.Render("~/bundles/jqueryval")
<form id="EmployeeExpenditure">
<div class="col-lg-12 usr-top-flds">

</div>

 <div class=" container-fluid emp-exd-frm margin-20 p-b-20">

 <div class="grid-hd col-lg-12 col-md-12 col-sm-12">
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 grid-headding">
                        <i class="fa fa-inr"></i> Submit Expenditure
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 text-right">
                    
             
@*        <div class="radio radio-success">
            <input id="yes" type="radio" name="optionyes" value="yes" checked="checked" />
            <label for="yes">
                Local</label>
            <input id="no" type="radio" name="optionyes" value="no" />
            <label for="no">
                Outstation</label>
      
   
                            <div class="clearfix">
                            </div>
                        </div>*@
                    </div>
                </div>


<div class="content-cont col-lg-12 col-md-12 no-padding" style="margin-top: 30px;">

<div class="col-lg-12" style="font-weight:bold;">
<div class="col-lg-2">Select Year</div>
<div class="col-lg-2">Select Month</div>
<div class="col-lg-6">Select Period Cycle</div>

</div>

    <div class="clearfix">
        </div>
    <div class="col-lg-12 m-t-20">
    
        <div class="col-lg-2 input-append success date">
            <select name="yearpicker" id="yearpicker" class="form-control"></select>
        </div>
        
        <div class="col-lg-2 input-append success date">
            <select name="month" id="month" onchange="" size="1" class="form-control">
                <option value="01">January</option>
                <option value="02">February</option>
                <option value="03">March</option>
                <option value="04">April</option>
                <option value="05">May</option>
                <option value="06">June</option>
                <option value="07">July</option>
                <option value="08">August</option>
                <option value="09">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
            </select>
        </div>

        <div class="col-lg-8 input-append success date">

<div class="col-lg-3 col-md-3" id="firstblock" style="float:left; background-color:#3DBEBA; padding:10px 0px; margin-right:2px; color:#fff;">
<div class="col-lg-1" style="float:left;">
<input type='radio' name='group' id='first' class="myradio" />
</div>

<div class="col-lg-9"  style="float:left;">
@*<span id="firstspan"></span>*@
<label for="first" id="firstspan" class="monthspanlabel"></label>
</div>

</div>


<div class="col-lg-4 col-md-4" id="secondblock" style="float:left; background-color:#7068F0; padding:10px 0px; margin-right:2px; color:#fff;">
<div class="col-lg-1" style="float:left;">
<input type='radio' name='group' id='second' class="myradio" />
</div>

<div class="col-lg-9" style="float:left;">
<label for="second" id="middlespan" class="monthspanlabel"></label>
@*<span id="middlespan"></span>*@
</div>

</div>


<div class="col-lg-4 col-md-4" id="thirdblock" style="float:left; background-color:#BEBCFA; padding:10px 0px; margin-right:2px; color:#fff;">
<div class="col-lg-1" style="float:left;">
<input type='radio' name='group' id='third' class="myradio" />
</div>

<div class="col-lg-9" style="float:left;">
@*<span id="lastspan"></span>*@
<label for="third" id="lastspan" class="monthspanlabel"></label>
</div>

</div>

           @* <select name="days" id="days" class="form-control"></select>*@
        </div>

    </div>


    </div>
    </div>



    <div class="row margin-20 prf-nav-tab" >
    <div class=" col-lg-12 col-md-12 no-padding">
        <div class="radio radio-success" style="background-color:#333645; color:#fff; height:58px;">
           
           <div class=" col-lg-3" id="yespart" style="padding:16px 40px;  color:#fff;" for="yes">
            <input id="yes" type="radio" name="optionyes" value="yes" checked="checked" />
            <label for="yes" id="yespartlabel">
                Local Expenditure</label>

                </div>

                <div class=" col-lg-3" id="nopart" style="padding:16px 32px;  color:#fff;" for="no">
            <input id="no" type="radio" name="optionyes" value="no" />
            <label for="no" id="nopartlabel">
                Outstation Expenditure</label>
      </div>
   
                            <div class="clearfix">
                            </div>
                        </div>


                        
         <div class="clearfix">
                            </div>

        <div class="tab-content">

    
         <div class="clearfix">
                            </div>



<div class="content-cont col-lg-12 col-md-12 no-padding" id="Localexpend" style="display: none;
    margin-top: 0px">
    <div class=" container-fluid emp-exd-frm margin-20 p-b-20">
   @*     <div class="grid-hd col-lg-12 col-md-12 col-sm-12">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 ">
                Local Expenditure</div>
        </div>
        <div class="clearfix">
        </div>*@
        <div class="col-lg-12 p-t-20">
        <div class="col-lg-2" style="font-weight:bold;">Expenditure Date :</div>

            <div class="col-lg-2 col-md-3 col-sm-6 col-xs-6">
                <div class="col-md-12 emp-exp-dt no-padding ">
                    <div class=" input-append success col-lg-12 no-padding">
                        <input type="text" id="txtDate" class="form-control" title="Select Date" />
                        <span class="add-on"><i id="faDate" class="fa fa-calendar" title="Select Date"></i>
                        </span>
                    </div>
                    <div class="clearfix">
                    </div>
                </div>
            </div>
            <div class="col-lg-1 col-md-2 col-sm-6 col-xs-6 m-t-10">
                <div class="checkbox check-info">
                    <input id="chkMobile" type="checkbox" />
                    <label for="chkMobile">
                        Mobile
                    </label>
                </div>
            </div>
            <div class="col-lg-1 col-md-2 col-sm-6 col-xs-6 m-t-10">
                <div class="checkbox check-info">
                    <input id="chkInternet" type="checkbox" />
                    <label for="chkInternet">
                        Internet
                    </label>
                </div>
            </div>
            <div class="clearfix">
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6  m-t-20" id="divMobileNo" style="display: none;">
                    <div class="controls">
                        <input type="text" id="txtMobileNo" placeholder="Mobile No" class="form-control numericOnly minLength"
                            title="Mobile No" maxlength="10" />
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6  m-t-20" id="divMobile">
                    <div class="controls">
                        <input type="text" id="txtMobileBill" placeholder="Bill Amount" class="form-control numericOnly1"
                            title="Bill Amount" maxlength="6" />
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6  m-t-20" id="divMobileComment" style="display: none">
                    <div class="controls">
                        <input type="text" id="txtMobileComment" placeholder="Comment For Mobile" class="form-control"
                            title="Comment For Mobile" maxlength="500" />
                    </div>
                </div>
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 m-t-10" id="divInternetNo">
                    <div class="controls">
                        <input type="text" id="txtInternetDataCard" placeholder="Data Card No" class="form-control numericOnly"
                            title="Data Card No" maxlength="10" />
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 m-t-10" id="divInternet">
                    <div class="controls">
                        <input type="text" id="txtInternetBill" placeholder="Internet Bill Amount" class="form-control numericOnly1"
                            title="Internet Bill Amount" maxlength="6" />
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 m-t-10" id="divInternetComment">
                    <div class="controls">
                        <input type="text" id="txtInternetComment" placeholder="Comment For Internet" class="form-control"
                            title="Comment For Internet" maxlength="500" />
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12 m-t-20" id="ClientSection">
            <div class="col-lg-4 col-md-4  m-b-10 ">
                <div class="controls">
                    <input type="text" id="txtCompanyName" placeholder="Company Name" class="form-control alphanumeric"
                        title="Company Name" maxlength="50" />
                </div>
            </div>
            <div class="col-lg-4 col-md-4 m-b-10">
                <div class="controls">
                    @if (ViewBag.ClientManagers != null)
                    {
                        @Html.DropDownList("txtClientManagerName", ViewBag.ClientManagers as List<SelectListItem>, new { @class = "form-control", @id = "txtClientManagerName", @Title = "Please Select Client Manager" })
                    }
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 ">
                <div class="col-lg-6 col-md-6 m-t-10 no-padding">
                    <div class="checkbox check-info">
                        <input id="chkMultiple" type="checkbox" />
                        <label for="chkMultiple">
                            Multiple SO Nos
                        </label>
                    </div>
                </div>
                <div class="col-lg-6 dfl-buttom col-md-6">
                    <input id="btnAdd" type="button" value="Add" />
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12" id="divService">
            <div class="col-lg-4 col-md-4 m-b-10">
                <div class="col-lg-3 col-md-3 no-padding" id="divSONoStatus">
                    <div class="controls">
                        <select id="ddlSONoStatus" class="form-control" title="Select Service Order Number Status">
                            <option value="0">SO Status</option>
                            <option value="1">Yes</option>
                            <option value="2">No</option>
                        </select>
                    </div>
                </div>
                <div id="divSONo" class="col-lg-9  col-md-9 " style="display: block">
                    <div class="controls">
                        <input type="text" id="txtSONo" placeholder="Service Order Number" class="form-control numericOnly"
                            title="Service Order Number" maxlength="15" />
                    </div>
                </div>
                <div id="divSOExplanation" class="col-lg-9 col-md-9 " style="display: none">
                    <div class="controls">
                        <input type="text" id="txtSOExplanation" placeholder="Service Order No Explanation"
                            class="form-control" title="Service Order Number Explanation" maxlength="100" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-4" id="divSOInstrument" style="display: none">
                <div class="controls">
                    <input type="text" id="txtSONoforInstrument" placeholder="Serial Number for instruments"
                        class="form-control" title="Serial Number for instruments" maxlength="20" />
                </div>
            </div>
            <div class="col-lg-4  col-md-4 no-padding" id="divSoNumTotal">
                <div class="col-lg-6 col-md-6  m-b-10" id="divSOCNo">
                    <div class="controls">
                        <input type="text" id="SOConfirmationNo" placeholder="Order Confirmation Number"
                            class="form-control numericOnly" title="Service Order Confirmation Number" maxlength="15" />
                    </div>
                </div>
                <div class="col-lg-6 col-md-6  m-b-10" id="divSOCNoDate">
                    <div class="controls">
                        <input type="text" id="txtOCDate" placeholder="Order Confirmation Date" class="form-control"
                            title="Service Order Confirmation Date" />
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12 m-b-10" id="TextBoxContainer">
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12" id="ExpenditureSection">
            <div class="col-lg-4 col-md-4  no-padding m-b-20">
                <div class="col-lg-4">
                    @if (ViewBag.ExpenseTypeDetailsList != null)
                    {
                        @Html.DropDownList("ddlExpenditureType", ViewBag.ExpenseTypeDetailsList as List<SelectListItem>, new { @class = "form-control", @id = "ddlExpenditureType", @Title = "Select Expenditure Type" })
                    }
                </div>
                <div id="divConveyance" class="col-lg-4 " style="display: none">
                    @Html.DisplayFor(Model => Model.Conveyance, new { @class = "form-control", id = "txtConveyance" })
                </div>
                <div class="col-lg-8  col-md-8 " id="LocFrom">
                    <div class="controls">
                        <input type="text" id="txtFrom" placeholder="From Location" class="form-control charOnly"
                            title="From Location" maxlength="50" />
                    </div>
                </div>
                <div class="col-lg-8" id="divReason" style="display: none">
                    <div class="controls">
                        <input type="text" id="txtReason" placeholder="Expense Details" class="form-control"
                            title="Expense Details" maxlength="100" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4  col-md-4 " style="padding-left: 0px;">
                <div class="col-lg-5 col-md-6 no-padding" id="divLocTo">
                    <div class="controls">
                        <input type="text" id="txtToLocation" class="form-control charOnly" placeholder="To Location"
                            title="To Location" maxlength="50" />
                    </div>
                </div>
                <div class="col-lg-3" id="divKm" style="display: inline">
                    <div class="controls">
                        <input type="text" id="txtKms" placeholder="KM’s" class="form-control numericOnly1"
                            title="Km's" maxlength="6" />
                    </div>
                </div>
                <div class="col-lg-4" id="divAmount">
                    <div class="controls">
                        <input type="text" id="txtAmount" placeholder="Amount" class="form-control numericOnly1"
                            title="Amount" maxlength="9" />
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12" id="CommentSection">
            <div class="col-lg-12  col-md-4 m-b-10">
                <div class="controls">
                    <input type="text" id="txtLocalComments" placeholder="Comments" class="form-control"
                        title="Comments" maxlength="1000" />
                </div>
            </div>
        </div>
        <div class="col-lg-3 pull-right" id="divBtnAddMoreExpenses">
            <div class="col-lg-12">
                <div class="controls">
                    <input type="submit" value="Add More Expenses" id="btnLocalAdd" class="form-control" />
                </div>
            </div>
        </div>
    </div>
</div>
<div class="content-cont col-lg-12 col-md-12 no-padding" id="Outexpend" style="display: none;
    margin-top: 0px;">
    <div class=" container-fluid emp-exd-frm margin-20 p-b-20">
 @*       <div class="grid-hd col-lg-12 col-md-12 col-sm-12">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 ">
                Outstation Expenditure</div>
        </div>*@
        <div class="col-lg-12 p-t-20">
         <div class="col-lg-2" style="font-weight:bold;">Expenditure Date :</div>

            <div class="col-lg-2 col-md-3 col-sm-6 col-xs-6  no-padding ">
                <div class="col-md-12 emp-exp-dt pull-right ">
                    <div class="input-append success date col-md-12 col-lg-12 no-padding">
                        <input type="text" class="form-control" id="txtOutstationDate" title="Select Date" />
                        <span class="add-on"><i class="fa fa-calendar"></i></span>
                    </div>
                    <div class="clearfix">
                    </div>
                </div>
            </div>
            <div class="col-lg-1 col-md-2 col-sm-6 col-xs-6" style="display: none">
                <div class="checkbox check-info">
                    <input id="chkOutMobile" type="checkbox" />
                    <label for="chkOutMobile">
                        Mobile
                    </label>
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12 p-t-20" id="divOutClientSection">
            <div class="col-lg-4 col-md-4  m-b-10 ">
                <div class="controls">
                    <input type="text" id="txtOutClientName" placeholder="Company Name" class="form-control alphanumeric"
                        title="Company Name" maxlength="50" />
                </div>
            </div>
            <div class="col-lg-4 col-md-4 m-b-10">
                <div class="controls">
                    @if (ViewBag.ClientManagers != null)
                    {
                        @Html.DropDownList("txtOutClientManagerName", ViewBag.ClientManagers as List<SelectListItem>, new { @class = "form-control", @id = "txtOutClientManagerName", @Title = "Please Select Client Manager" })
                    }
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 m-t-10 m-b-10">
                <div class="col-lg-6 col-md-6 no-padding">
                    <div class="checkbox check-info">
                        <input id="chkOutMultiple" type="checkbox" />
                        <label for="chkOutMultiple">
                            Multiple SO Nos
                        </label>
                    </div>
                </div>
                <div class="col-lg-6 dfl-buttom col-md-6">
                    <input id="btnOutAddSONOs" type="button" value="Add" />
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12 m-b-10" id="TextBoxContainerForOut">
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12" id="divOutExpenditureTypes">
            <div class="col-lg-4 col-md-4 m-b-10">
                <div class="col-lg-3 col-md-3 no-padding ">
                    <div class="controls">
                        <select id="ddlOutSONoStatus" class="form-control" title="Select Service Order Number Status">
                            <option value="0">Select Service Order Status</option>
                            <option value="1">Yes</option>
                            <option value="2">No</option>
                        </select>
                    </div>
                </div>
                <div id="divOutSONo" class="col-lg-9 col-md-9 " style="display: block">
                    <div class="controls">
                        <input type="text" id="txtOutSONo" placeholder="Service Order Number" class="form-control numericOnly"
                            title="Service Order Number" maxlength="15" />
                    </div>
                </div>
                <div id="divOutSOExplanation" class="col-lg-9 col-md-9 m-b-10  " style="display: none">
                    <div class="controls">
                        <input type="text" id="txtOutSOExplanation" placeholder="Service Order No Explanation"
                            class="form-control" title="Service Order Number Explanation" maxlength="100" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4  col-md-4" id="instrumentTotal" style="display: none">
                <div id="divOutSOInstrument" style="display: none">
                    <div class="controls">
                        <input type="text" id="txtOutSONoforInstrument" placeholder="Serial Number for instruments"
                            class="form-control" title="Serial Number for instruments" maxlength="20" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-4  m-b-10" id="divOutSOCNo">
                <div class="controls">
                    <input type="text" id="OutSOConfirmationNo" placeholder="Order Confirmation Number"
                        class="form-control numericOnly" title="Service Order Confirmation Number" maxlength="15" />
                </div>
            </div>
            <div class="col-lg-4 col-md-4  m-b-10" id="divOutSOCNoDate">
                <div class="controls">
                    <input type="text" id="txtOutOCDate" placeholder="Order Confirmation Date" class="form-control"
                        title="Service Order Confirmation Date" />
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12">
            <div class="col-lg-4">
                <div class="col-lg-6 col-md-6  m-b-20">
                    @Html.DropDownList("ExpenditureType", ViewBag.ExpenseTypeList as List<SelectListItem>, "Select Expenditure Type", new { @class = "form-control", @id = "ddlOutExpenditureType", @Title = "Expenditure Type" })
                </div>
                <div class="col-lg-6">
                    <select id="ddlOutExpenditureTypeDetail" class="form-class form-control" title="Select Expenditure Type Details">
                        <option value="0">Select Expenditure Type Details</option>
                    </select>
                </div>
            </div>
            <div class="col-lg-4  col-md-3 no-padding">
                <div class="col-lg-6  col-md-6" id="divOutFrom">
                    <div class="controls">
                        <input type="text" id="txtOutFrom" placeholder="From Location" class="form-control charOnly"
                            title="From Location" maxlength="50" />
                    </div>
                </div>
                <div class="col-lg-6 col-md-6" id="divOutTo">
                    <div class="controls">
                        <input type="text" id="txtOutToLocation" class="form-control charOnly" placeholder="To Location"
                            title="To Location" maxlength="50" />
                    </div>
                </div>
                <div class="col-lg-12" id="divOutReason" style="display: none">
                    <div class="controls">
                        <input type="text" id="txtOutReason" placeholder="Expense Details" class="form-control"
                            title="Expense Details" maxlength="500" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 m-b-20">
                <div class="controls">
                    <input type="text" id="txtOutAmount" placeholder="Amount" class="form-control numericOnly1"
                        title="Amount" maxlength="9" />
                </div>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="col-lg-12">
            <div class="col-lg-12 no-padding col-md-4 m-b-10">
                <div class="controls">
                    <input type="text" id="txtComments" placeholder="Comments" class="form-control" title="Comments"
                        maxlength="1000" />
                </div>
            </div>
        </div>
        <div class="col-lg-12">
            <div class="col-lg-3 no-padding pull-right">
                <div class="col-lg-12 no-padding ">
                    <div class="controls">
                        <input type="submit" value="Add More Expenses" id="btnOutAdd" class="form-control" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>





        </div>
    </div>
</div>



<div class="popuppositionsucess">
    <div class="alert alert-success" id="localexpendituresubmit" runat="server">
        <strong>Success !</strong><br />
        <label id="sucessresult">
        </label>
    </div>
</div>
<div class="popupposition">
    <div class="alert alert-warning" id="Expenditurewarning" runat="server">
        <strong>Warning !</strong><br />
        <label id="errormessage">
        </label>
    </div>
</div>
<div id="expenselist" class="content-cont" style="margin-top: 0px">
</div>
<div id="divSONos" class="content-cont" style="margin-top: 0px">
</div>
@*submit and reset buttons*@
<div class="col-lg-6 pull-right dfl-buttom  no-padding " style="" id="divLocal1">
    <div class=" col-lg-4 col-md-4 ">
        <input type="submit" value="Save" name="Save" id="btnSave" />
    </div>
    <div class=" col-lg-4 col-md-4 ">
        <input type="submit" value="Submit" name="Submit" id="btnSubmit" />
    </div>
    <div class=" col-lg-4 col-md-4 ">
        <input type="reset" id="btnReset" name="Reset" value="Reset" />
    </div>
    @if (ViewBag.ExpenseHeaderID != null)
    {
        @Html.TextBox("txtExistingHeaderID", (int)ViewBag.ExpenseHeaderID, new { @id = "txtExistingHeaderID", @style = "Display:none" })
    }
    <input type="text" id="txtHeaderID" style="display: none" />
    @Html.TextBoxFor(Model => Model.Conveyance, new { @id = "txtConveyanceValue", @style = "display:none" })
</div>
@*submit and reset button for outstation expense*@
<div class="col-lg-6 pull-right dfl-buttom" style="display: none;" id="divOutstation">
    <div class=" col-lg-4 col-md-4 ">
        <input type="submit" value="Save" name="Save" id="btnOutSave" /></div>
    <div class=" col-lg-4 col-md-4 ">
        <input type="submit" value="Submit" name="Submit" id="btnOutSubmit" /></div>
    <div class=" col-lg-4 col-md-4 ">
        <input type="reset" id="btnOutReset" value="Reset" name="Reset" /></div>
</div>
<!--[if lt IE 10]>
 <script type="text/javascript">
     $(function () {
         // Invoke the plugin
         $('input, textarea').placeholder({ customClass: 'my-placeholder' });

     });
		</script>
          <![endif]-->
<script type="text/javascript">


    $(document).ready(function () {

        $('#yespart').css('background-color', '#08A9C6');
        $('#yespartlabel').css('color', '#fff');
        $('#nopartlabel').css('color', '#fff');

        $("#yes").change(function () {
            if ($(this).is(":checked")) {
                var val = $(this).val();
            
                if (val == 'yes') {

                    $('#yespart').css('background-color', '#08A9C6');
                    $('#nopart').css('background-color', '#333645');
                    $('#yespartlabel').css('color', '#fff');
                 

                }

            }
        });


        $("#no").change(function () {
            if ($(this).is(":checked")) {
                var val = $(this).val();
           
                if (val == 'no') {
                    $('#nopart').css('background-color', '#08A9C6');
                    $('#yespart').css('background-color', '#333645');
                    $('#nopartlabel').css('color', '#fff');

                }

            }
        });
    });






    var expenditureDate = "";

    function FillDates() {

        var year = $('#yearpicker').val();
        var month = $('#month').val();
        var days = Math.round(((new Date(year, month)) - (new Date(year, month - 1))) / 86400000);

        $('#first').prop("checked", false);
        $('#second').prop("checked", false);
        $('#third').prop("checked", false);

        $("#firstspan").text('');
        newOption = "1 to 10 Days";
        $("#firstspan").append(newOption);
        $("#middlespan").text('');
        newOption = "11 to 20 Days";
        $("#middlespan").append(newOption);
        $("#lastspan").text('');
        newOption = "21 to " + days + " Days";
        $("#lastspan").append(newOption);

        SDate = 1 + "/" + month + "/" + year;

        ValidateBlockedDatesDate(SDate);

    }

    function ValidateBlockedDatesDate(selectedDate) {

        $.ajax({
            url: '/Employee/CheckExpenditure',
            type: "GET",
            cache: false,
            data: { ExpenditureDate: selectedDate, FromPage: 'Expense' },
            success: function (data) {

                if (data.SpanOneBlockedDates == 1) {
                    $('#firstblock').css('background-color', 'Orange');
                    $('#first').attr('disabled', false);

                }
                else if (data.SpanOneBlockedDates == 0) {
                    $('#first').attr('disabled', true);
                    $('#firstblock').css('background-color', '#ccc');


                }

                if (data.SpanTwoBlockedDates == 1) {
                    $('#secondblock').css('background-color', 'Orange');
                    $('#second').attr('disabled', false);
                }
                else if (data.SpanTwoBlockedDates == 0) {
                    $('#secondblock').css('background-color', '#ccc');
                    $('#second').attr('disabled', true);

                }

                if (data.SpanThreeBlockedDates == 1) {
                    $('#thirdblock').css('background-color', 'Orange');
                    $('#third').attr('disabled', false);
                }
                else if (data.SpanThreeBlockedDates == 0) {
                    $('#thirdblock').css('background-color', '#ccc');
                    $('#third').attr('disabled', true);

                }

                var vD = new Date();

                var year = $('#yearpicker').val();
                var month = $('#month').val();

                var currentDay = vD.getDate();
                var currentMonth = ("0" + (vD.getMonth() + 1)).slice(-2);
                var currentYear = vD.getFullYear();

                var currentMonth = ("0" + (vD.getMonth() + 1)).slice(-2);

                var past = ("0" + (vD.getMonth() + 1)).slice(-2) - 01;


                if (currentMonth == month && currentYear == year) {

                    if (currentDay > 0 && currentDay < 13 && data.SpanOneBlockedDates == 0) {
                        $('#first').attr('disabled', false);

                        if (currentDay > 10) {
                            $('#firstblock').css('background-color', 'Orange');
                        }
                        else {
                            $('#firstblock').css('background-color', '#4CAF50');

                        }
                    }

                    if (currentDay > 10 && currentDay < 23 && data.SpanTwoBlockedDates == 0) {
                        $('#second').attr('disabled', false);

                        if (currentDay > 20) {
                            $('#secondblock').css('background-color', 'Orange');

                        }
                        else {
                            $('#secondblock').css('background-color', '#4CAF50');
                        }
                    }

                    if (currentDay > 20 && data.SpanThreeBlockedDates == 0) {
                        $('#third').attr('disabled', false);
                        $('#thirdblock').css('background-color', '#4CAF50');
                    }
                }
                else if (past == month && month > 0) {
                    if (currentDay > 0 && currentDay < 3 && data.SpanThreeBlockedDates == 0) {
                        $('#third').attr('disabled', false);
                        $('#thirdblock').css('background-color', '#Orange');
                    }
                }
                else if (past == 0 && month == 12) {
                    if (currentDay > 0 && currentDay < 3 && data.SpanThreeBlockedDates == 0) {
                        $('#third').attr('disabled', false);
                        $('#thirdblock').css('background-color', '#Orange');
                    }
                }


            },
            error: function (event, jqxhr, settings, exception) {
                alert(exception);
            }
        });
    }


    $(document).ready(function () {

        var d = new Date();
        var n = ("0" + (d.getMonth() + 1)).slice(-2);
        $('#month').val(n);


        for (i = new Date().getFullYear(); i > new Date().getFullYear() - 2; i--) {
            $('#yearpicker').append($('<option />').val(i).html(i));
        }

        FillDates();

        $("#month,#yearpicker").change(function () {
            FillDates();
            $('#txtDate').val('');
            $('#txtOutstationDate').val('');
            $("#txtDate").datepicker("remove");
            $("#txtOutstationDate").datepicker("remove");
        });

        var currentDay = d.getDate();
        var year = $('#yearpicker').val();
        var month = $('#month').val();
        if (currentDay >= 1 && currentDay <= 10) {

            $('#first').prop("checked", true);
            $('#second').prop("checked", false);
            $('#third').prop("checked", false);

            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 01));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, 10));

            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 01));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, 10));

        }
        else if (currentDay >= 11 && currentDay <= 20) {
            $('#first').prop("checked", false);
            $('#second').prop("checked", true);
            $('#third').prop("checked", false);

            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 11));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, 20));

            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 11));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, 20));

        }
        else {

            $('#first').prop("checked", false);
            $('#second').prop("checked", false);
            $('#third').prop("checked", true);

            var days = Math.round(((new Date(year, month)) - (new Date(year, month - 1))) / 86400000);

            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 21));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, days));

            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 21));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, days));

        }

        $('#first').change(function () {
            var year = $('#yearpicker').val();
            var month = $('#month').val();
            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 01));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, 10));
            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 01));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, 10));
        });

        $('#second').change(function () {
            var year = $('#yearpicker').val();
            var month = $('#month').val();
            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 11));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, 20));
            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 11));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, 20));
        });

        $('#third').change(function () {
            var year = $('#yearpicker').val();
            var month = $('#month').val();
            var days = Math.round(((new Date(year, month)) - (new Date(year, month - 1))) / 86400000);
            $('#txtDate').datepicker('setStartDate', new Date(year, month - 1, 21));
            $('#txtDate').datepicker('setEndDate', new Date(year, month - 1, days));
            $('#txtOutstationDate').datepicker('setStartDate', new Date(year, month - 1, 21));
            $('#txtOutstationDate').datepicker('setEndDate', new Date(year, month - 1, days));
        });

        var keyDown = false, ctrl1 = 17, vKey1 = 86, Vkey1 = 118;
        $('.numericOnly').keydown(function (e) {
            if (e.keyCode == ctrl1) keyDown = true;
        }).keyup(function (e) {
            if (e.keyCode == ctrl1) keyDown = false;
        });

        $('.numericOnly').on('keypress', function (event) {
            if ((event.which < 48 || event.which > 57) && event.which != 8 && event.which != 0 && event.which != 118 && event.which != 99) {
                event.preventDefault();
            }
        }).on('focusout', function (e) {
            var $this = $(this);
            $this.val($this.val().replace(/[^0-9]/g, ''));
        }).on('paste', function (e) {
            var $this = $(this);
            setTimeout(function () {
                $this.val($this.val().replace(/[^0-9]/g, ''));
            }, 5);
        });

        //for taking chars only
        $('.charOnly').on('keypress', function (e) {
            if (!e) var e = window.event;
            if (e.keyCode > 0 && e.which == 0) return true;
            if (e.keyCode) code = e.keyCode;
            else if (e.which) code = e.which;
            var character = String.fromCharCode(code);
            if (character == '\b' || character == ' ' || character == '\t') return true;
            if (keyDown && (code == vKey1 || code == Vkey1)) return (character);
            else return (/[aA-zZ ]$/.test(character));
        }).on('focusout', function (e) {
            var $this = $(this);
            $this.val($this.val().replace(/[^aA-zZ '']/g, ''));
        }).on('paste', function (e) {
            var $this = $(this);
            setTimeout(function () {
                $this.val($this.val().replace(/[^aA-zZ '']/g, ''));
            }, 5);
        });

        //for numeric only
        $('.numericOnly1').on('keypress', function (event) {
            if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57) && event.which != 8 && event.which != 0 && event.which != 118 && event.which != 99) {
                event.preventDefault();
            }
            if (($(this).val().indexOf('.') != -1) && event.which != 8 && ($(this).val().substring($(this).val().indexOf('.'), $(this).val().indexOf('.').length).length > 2)) {
                event.preventDefault();
            }
        }).on('focusout', function (e) {
            var $this = $(this);
            $this.val($this.val().replace(/[^0-9.]/g, ''));
        }).on('paste', function (e) {
            var $this = $(this);
            setTimeout(function () {
                $this.val($this.val().replace(/[^0-9.]/g, ''));
            }, 5);
        });

        $('.popupposition').hide();
        $(".popuppositionsucess").hide();

        var multipleCheck = "";
        var counter = 1;
        var ExpenditureHeaderID = "";
        var ClientName = "";
        var ClientManagerStatus = "";
        var ClientManagerName = "";
        var SOServiceStatus = "";
        var SONo = "";
        var SOExplanation = "";
        var OrderConfirmationNo = "";
        var FromLocation = "";
        var ToLocation = "";
        var ExpenditureType = "";
        var Kms = "";
        var Conveyance = "";
        var Amount = "";
        var ExpenditureTypeDetail = "";
        var Localization = "";
        var Reason = "";
        var comments = "";
        var Mobile = "";
        var Internet = "";
        var MobileID = "";
        var InternetID = "";
        var FromStatus = "";
        var SONoInstruments = "";
        var OrderConfirmationDate = "";
        var ExistingHeaderID = "";
        var MobileNo = "";
        var MobileComment = "";
        var InternetNo = "";
        var InternetComment = "";
        var MobileSelect = "";
        var InternetSelect = "";
        var MultipleArrayValues = [];

        $('#chkMultiple').attr('checked', false);
        $('#TextBoxContainer').hide();
        $('#btnAdd').hide();
        $('#SingleSoNos').show();

        $('#chkMultiple').click(function (e) {
            $('#ddlSONoStatus').val(0);
            $('#txtSONo').val('');
            $('#SOConfirmationNo').val('');
            $('#txtSOExplanation').val('');
            $('#txtSONoforInstrument').val('');
            var chkstatus = $('#chkMultiple').is(":checked")
            if (chkstatus == true) {
                $('#TextBoxContainer').show();
                $('#btnAdd').show();
                $('#divService').hide();
                counter = 1;
            }
            else {
                $('#TextBoxContainer').hide();
                $('#btnAdd').hide();
                $('#divService').show();
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    counter--;
                });
                counter = 1;
            }
        });

        $('#TextBoxContainerForOut').hide();
        $('#btnOutAddSONOs').hide();
        $('#divOutExpenditureTypes').show();
        $('#chkOutMultiple').click(function () {
            $('#ddlOutSONoStatus').val(0);
            $('#txtOutSONo').val('');
            $('#OutSOConfirmationNo').val('');
            $('#txtOutSOExplanation').val('');
            $('#txtOutSONoforInstrument').val('');
            var chkOutStatus = $('#chkOutMultiple').is(":checked")
            if (chkOutStatus == true) {
                $('#TextBoxContainerForOut').show();
                $('#btnOutAddSONOs').show();
                $('#divOutExpenditureTypes').hide();
                counter = 1;
            }
            else {
                $('#TextBoxContainerForOut').hide();
                $('#btnOutAddSONOs').hide();
                $('#divOutExpenditureTypes').show();
                $('#TextBoxContainerForOut').find('div').each(function () {
                    $(this).remove();
                    counter--;
                });
                counter = 1;
            }
        });

        $("#btnOutAddSONOs").bind("click", function () {
            if (counter <= 10 && counter > 1) {
                var values = "";
                $(".ddlMultiStatus").last().each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                                var div = $("<div />");
                                div.html(GetOutDynamicTextBox(""));
                                $("#TextBoxContainerForOut").append(div);
                                counter++;
                                $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {
                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            var div = $("<div />");
                                            div.html(GetOutDynamicTextBox(""));
                                            $("#TextBoxContainerForOut").append(div);
                                            counter++;
                                            $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        return false;
                                    }
                                }
                                else {
                                    var div = $("<div />");
                                    div.html(GetOutDynamicTextBox(""));
                                    $("#TextBoxContainerForOut").append(div);
                                    counter++;
                                    $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        this.focus();
                        return false;
                    }
                });
            }
            else {
                if (counter > 5) {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Only 10 options allow');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    return false;
                }
                else {
                    var div = $("<div />");
                    div.html(GetOutDynamicTextBox(""));
                    $("#TextBoxContainerForOut").append(div);
                    counter++;
                    $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                }
            }
        });

        function GetOutDynamicTextBox(value) {
            return '<div class=Multiple><div class="col-lg-12" id="div' + counter + '">'
                + '<div class="col-lg-2 col-md-2">' +
                    '<div class="controls">' +
                        '<select class="ddlMultiStatus" name="MultiStatus" title="Select Service Order Number Status" id="ddlMultiStatus' + counter + '">' +
                            '<option value="0">SO Status</option>' +
                            '<option value="1">Yes</option>' +
                            '<option value="2">No</option>' +
                        '</select>' +
                    '</div>' +
                '</div>' +
                '<div class="MultiSONo" style="display: block"><div class="col-lg-3 col-md-3 no-padding ">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtSONo" placeholder="Service Order Number" class="form-control numericOnly"' +
                            'title="Service Order Number" maxlength="15" />' +
                    '</div>' +
                '</div></div>' +
                '<div class="MultiSOExplanation" style="display: none"><div class="col-lg-3 col-md-3 no-padding ">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtSOExplanation" placeholder="Service Order No Explanation"' +
                            'class="form-control" title="Service Order Number Explanation" maxlength="100" />' +
                    '</div>' +
                '</div></div>' +
            '</div>' +
            '<div class="MultiSOInstrument" style="display: none;" ><div class="col-lg-3 col-md-3">' +
                '<div class="controls">' +
                    '<input type="text" name="txtSONoforInstrument" placeholder="Serial Number for instruments"' +
                        'class="form-control" title="Serial Number for instruments" maxlength="20" />' +
                '</div>' +
            '</div></div>' +
            '<div class="MultiSOCN"><div class="col-lg-3 col-md-3 ">' +
                '<div class="controls">' +
                        '<input type="text" name="SOConfirmationNo" placeholder="Order Confirmation Number"' +
                            'class="form-control numericOnly" title="Service Order Confirmation Number" maxlength="15" />' +
                    '</div>' +
                '</div>' +
                '<div class="MultiSOCD"><div class="col-lg-2 col-md-2 no-padding">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtOCDate" placeholder="Order Confirmation Date" class="form-control"' +
                            'title="Service Order Confirmation Date" />' +
                    '</div>' +
                '</div></div>' +
            '</div></div>' +
            '&nbsp;' +
            '<input type="button" value="Remove" class="Outremove" style="background:none !important; border:none !important; background-color:#333645 !important; color:#a7aec2; padding:10px; margin-left:10px; width:13%;  border-radius: 5px;" />' +
            '<div class="clearfix"></div>'
        }

        $("body").on("click", ".Outremove", function () {
            $(this).closest("div").remove();
            counter--;
        });

        //assign datepickers to dynamically added date-textboxes 
        $('body').on('focus', "input[name=txtOCDate]", function () {
            if ($(this).hasClass('hasDatepicker') === false) {
                $(this).datepicker();
            }
        });

        $('body').on('changeDate', "input[name=txtOCDate]", function () {
            $(this).datepicker('hide');
        });

        //Allow users to enter numbers only for Dynamically added textboxes
        $('body').on('keypress', ".numericOnly", function (event) {
            if ((event.which < 48 || event.which > 57) && event.which != 8 && event.which != 0 && event.which != 118 && event.which != 99) {
                event.preventDefault();
            }
        }).on('focusout', function (e) {
            var $this = $(this);
            $this.val($this.val().replace(/[^0-9]/g, ''));
        }).on('paste', function (e) {
            var $this = $(this);
            setTimeout(function () {
                $this.val($this.val().replace(/[^0-9]/g, ''));
            }, 5);
        });

        $(".charOnly").bind('keypress', function (e) {
            if ((e.which > 64 && e.which < 91) || (e.which > 96 && e.which < 123) || e.which == 8 || e.which == 32 || e.which == 0 || e.which == 46)
                return true;
            else {
                return false;
            }
        });

        $().ready(function () {
            $('.alphanumeric').keyup(removeextra).blur(removeextra);
        });

        function removeextra() {
            var initVal = $(this).val();
            outputVal = initVal.replace(/[^0-9a-zA-Z '']/g, "");
            if (initVal != outputVal) {
                $(this).val(outputVal);
            }
        };

        $('.alphanumeric').keypress(function (e) {
            if (e.charCode != 0) {
                var regex = new RegExp("^[0-9a-zA-Z ]+$");
                var key = String.fromCharCode(!e.charCode ? e.which : e.charCode);
                if (!regex.test(key)) {
                    e.preventDefault();
                    return false;
                }
            }
        });

        $("#btnAdd").bind("click", function () {
            if (counter <= 10 && counter > 1) {
                var values = "";
                $(".ddlMultiStatus").last().each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                                var div = $("<div />");
                                div.html(GetDynamicTextBox(""));
                                $("#TextBoxContainer").append(div);
                                counter++;
                                $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {

                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            var div = $("<div />");
                                            div.html(GetDynamicTextBox(""));
                                            $("#TextBoxContainer").append(div);
                                            counter++;
                                            $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        return false;
                                    }
                                }
                                else {
                                    var div = $("<div />");
                                    div.html(GetDynamicTextBox(""));
                                    $("#TextBoxContainer").append(div);
                                    counter++;
                                    $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        this.focus();
                        return false;
                    }
                });
            }
            else {
                if (counter > 5) {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Only 10 options allow');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    return false;
                }
                else {
                    var div = $("<div />");
                    div.html(GetDynamicTextBox(""));
                    $("#TextBoxContainer").append(div);
                    counter++;
                    $('input, textarea').placeholder({ customClass: 'my-placeholder' });
                }
            }
        });

        $("body").on("click", ".remove", function () {
            $(this).closest("div").remove();
            counter--;
        });

        function GetDynamicTextBox(value) {

            return '<div class=Multiple><div class="col-lg-12" id="div' + counter + '">'
                + '<div class="col-lg-2 col-md-2">' +
                    '<div class="controls">' +
                        '<select class="ddlMultiStatus" name="MultiStatus" title="Select Service Order Number Status" id="ddlMultiStatus' + counter + '">' +
                            '<option value="0">SO Status</option>' +
                            '<option value="1">Yes</option>' +
                            '<option value="2">No</option>' +
                        '</select>' +
                    '</div>' +
                '</div>' +
                '<div class="MultiSONo" style="display: block"><div class="col-lg-3 col-md-3 no-padding ">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtSONo" placeholder="Service Order Number" class="form-control numericOnly"' +
                            'title="Service Order Number" maxlength="15" />' +
                    '</div>' +
                '</div></div>' +
                '<div class="MultiSOExplanation" style="display: none"><div class="col-lg-3 col-md-3 no-padding ">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtSOExplanation" placeholder="Service Order No Explanation"' +
                            'class="form-control" title="Service Order Number Explanation" maxlength="100" />' +
                    '</div>' +
                '</div></div>' +
            '</div>' +
            '<div class="MultiSOInstrument" style="display: none;" ><div class="col-lg-3 col-md-3">' +
                '<div class="controls">' +
                    '<input type="text" name="txtSONoforInstrument" placeholder="Serial Number for instruments"' +
                        'class="form-control" title="Serial Number for instruments" maxlength="20" />' +
                '</div>' +
            '</div></div>' +
            '<div class="MultiSOCN"><div class="col-lg-3 col-md-3 ">' +
                '<div class="controls">' +
                        '<input type="text" name="SOConfirmationNo" placeholder="Order Confirmation Number"' +
                            'class="form-control numericOnly" title="Service Order Confirmation Number" maxlength="15" />' +
                    '</div>' +
                '</div>' +
                '<div class="MultiSOCD"><div class="col-lg-2 col-md-2 no-padding">' +
                    '<div class="controls">' +
                        '<input type="text" name="txtOCDate" placeholder="Order Confirmation Date" class="form-control"' +
                            'title="Service Order Confirmation Date" />' +
                    '</div>' +
                '</div></div>' +
            '</div></div>' +
            '&nbsp;' +
            '<input type="button" value="Remove" class="remove" style="background:none !important; border:none !important; background-color:#333645 !important; color:#a7aec2; padding:10px; margin-left:10px; width:13%;  border-radius: 5px;" />' +
            '<div class="clearfix"></div>'
        }


        $('body').on('change', '.ddlMultiStatus', function (e) {
            var statusID = this.value;
            if (statusID == 2) {
                $(this).closest('.Multiple').find('.MultiSOExplanation').show();
                $(this).closest('.Multiple').find('.MultiSOInstrument').show();
                $(this).closest('.Multiple').find('.MultiSONo').hide();
                $(this).closest('.Multiple').find('.MultiSOCN').hide();
                $(this).closest('.Multiple').find('.MultiSOCD').hide();
                $(this).closest('.Multiple').find('input[name=txtSONo]').val('');
                $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val('');
                $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val('');
                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val('');
            }
            else {
                $(this).closest('.Multiple').find('.MultiSOExplanation').hide();
                $(this).closest('.Multiple').find('.MultiSOInstrument').hide();
                $(this).closest('.Multiple').find('.MultiSONo').show();
                $(this).closest('.Multiple').find('.MultiSOCN').show();
                $(this).closest('.Multiple').find('.MultiSOCD').show();
                $(this).closest('.Multiple').find('input[name=txtSONo]').val('');
                $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val('');
                $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val('');
                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val('');
            }
        });


        //bind datepickers to controlers
        //$('#txtDate').datepicker();
        $("#txtOCDate").datepicker("setDate", new Date());
        $('#txtOutstationDate').datepicker();
        $("#txtOutOCDate").datepicker("setDate", new Date());
        $('#divKm').hide();

        ExistingHeaderID = $("#txtExistingHeaderID").val();

        //from drafted expenditure
        if (ExistingHeaderID > 0) {
            $('#txtHeaderID').val(ExistingHeaderID);
            ExpenditureHeaderID = ExistingHeaderID;
            if (ExpenditureHeaderID > 0) {
                $.ajax({
                    url: '/Employee/DraftedExpenditure',
                    type: "GET",
                    data: { FromHeaderID: ExpenditureHeaderID },
                    success: function (DataDetails) {
                        if (DataDetails.length > 0) {
                            $.each(DataDetails, function (i, headerData) {
                                if (headerData.Localization == 'Outstation') {
                                    $('#no').prop("checked", true);
                                    $('#yes').prop("checked", false);
                                    $('#divOutstation').show();
                                    $('#divLocal1').hide();
                                    $('#divOutMobileNo').hide();
                                    $('#divOutMobile').hide();
                                    $('#divOutMobileComment').hide();
                                    $('#divOutInternetNo').hide();
                                    $('#divOutInternet').hide();
                                    $('#divOutInternetComment').hide();
                                    $('#Outexpend').show();
                                    $('#Localexpend').hide();
                                    var date = new Date(parseInt(headerData.FromDate.substr(6)));
                                    // format display date (e.g. 04/10/2012)
                                    var displayDate = $.datepicker.formatDate("dd/mm/yy", date);


                                    var n = ("0" + (date.getMonth() + 1)).slice(-2);
                                    $('#month').val(n);
                                    var y = date.getFullYear();
                                    $('#yearpicker').val(y);


                                    var year = $('#yearpicker').val();
                                    var month = $('#month').val();
                                    var days = Math.round(((new Date(year, month)) - (new Date(year, month - 1))) / 86400000);

                                    var d = date.getDate();

                                    if (d > 0 && d <= 10) {
                                        $('#days').val(10);
                                    }
                                    else if (d > 10 && d <= 20) {
                                        $('#days').val(20);
                                    }
                                    else {
                                        $('#days').val(days);
                                    }

                                    $('#yearpicker').attr('disabled', true);
                                    $('#month').attr('disabled', true);
                                    $('#days').attr('disabled', true);

                                    $('#txtOutstationDate').datepicker();

                                    $('#txtOutstationDate').val(displayDate);
                                    expenditureDate = displayDate;
                                    $('#txtOutClientName').val(headerData.ClientName);
                                    var text1 = headerData.ClientManagerName;
                                    $("#txtOutClientManagerName option").filter(function () {
                                        return this.text == text1;
                                    }).attr('selected', true);

                                    if (headerData.ServiceOrderNo != null) {
                                        $('#ddlOutSONoStatus').val("1");
                                        $("#divOutSOExplanation").hide();
                                        $("#divOutSOInstrument").hide();
                                        $("#divOutSONo").show();
                                        $('#divOutSOCNo').show();
                                        $('#divOutSOCNoDate').show();
                                    }
                                    else if (headerData.ExplanationforSONo != null) {
                                        $('#ddlOutSONoStatus').val("2");
                                        $("#divOutSOExplanation").show();
                                        $("#instrumentTotal").show();
                                        $('#divOutSOInstrument').show();
                                        $("#divOutSONo").hide();
                                        $('#divOutSOCNo').hide();
                                        $('#divOutSOCNoDate').hide();
                                    }
                                    else {
                                        $('#chkOutMultiple').attr('checked', true);
                                        $('#TextBoxContainerForOut').show();
                                        $('#btnOutAddONOs').show();
                                        $('#divOutExpenditureTypes').hide();
                                        MultipleSONOListView(ExpenditureHeaderID);
                                        $('#btnOutAddSONOs').show();
                                    }
                                    $('#chkOutMultiple').attr('disabled', true);
                                    $('#txtOutSONo').val(headerData.ServiceOrderNo);
                                    $('#txtOutSOExplanation').val(headerData.ExplanationforSONo);
                                    $("#txtOutSONoforInstrument").val(headerData.SerialNoforInstrument);
                                    $('#OutSOConfirmationNo').val(headerData.ServiceOrderConfirmationNo);

                                    var ocdate = new Date(parseInt(headerData.ServiceOrderConfirmationDate.substr(6)));
                                    // format display date (e.g. 04/10/2012)
                                    var ocdisplayDate = $.datepicker.formatDate("dd/mm/yy", ocdate);

                                    $('#txtOutOCDate').val(ocdisplayDate);
                                    $('#txtOutOCDate').datepicker("update");
                                    //readonly controls
                                    $('#txtOutstationDate').attr('disabled', true);
                                    $('#txtOutClientName').attr('disabled', true);
                                    $('#txtOutClientManagerName').attr('disabled', true);
                                }
                                else {
                                    $('#no').prop("checked", false);
                                    $('#yes').prop("checked", true);
                                    $('#divOutstation').hide();
                                    $('#divLocal1').show();
                                    $('#Outexpend').hide();
                                    $('#Localexpend').show();
                                    var date = new Date(parseInt(headerData.FromDate.substr(6)));
                                    // format display date (e.g. 04/10/2012)

                                    var n = ("0" + (date.getMonth() + 1)).slice(-2);
                                    $('#month').val(n);
                                    var y = date.getFullYear();
                                    $('#yearpicker').val(y);


                                    var year = $('#yearpicker').val();
                                    var month = $('#month').val();
                                    var days = Math.round(((new Date(year, month)) - (new Date(year, month - 1))) / 86400000);

                                    var d = date.getDate();

                                    if (d > 0 && d <= 10) {
                                        $('#days').val(10);
                                    }
                                    else if (d > 10 && d <= 20) {
                                        $('#days').val(20);
                                    }
                                    else {
                                        $('#days').val(days);
                                    }

                                    $('#yearpicker').attr('disabled', true);
                                    $('#month').attr('disabled', true);
                                    $('#days').attr('disabled', true);


                                    $('#txtDate').datepicker();

                                    var displayDate = $.datepicker.formatDate("dd/mm/yy", date);
                                    $('#txtDate').val(displayDate);
                                    expenditureDate = displayDate;
                                    $('#txtCompanyName').val(headerData.ClientName);
                                    var text1 = headerData.ClientManagerName;
                                    $("#txtClientManagerName option").filter(function () {
                                        return this.text == text1;
                                    }).attr('selected', true);
                                    $('#chkMobile').attr('disabled', true);
                                    $('#chkInternet').attr('disabled', true);
                                    if (headerData.ServiceOrderNo != null) {
                                        $('#ddlSONoStatus').val("1");
                                        $("#divSOExplanation").hide();
                                        $("#divSOInstrument").hide();
                                        $("#divSONo").show();
                                        $('#divSoNumTotal').show();
                                        $("#divSOCNo").show();
                                        $("#divSOCNoDate").show();
                                    }
                                    else if (headerData.ExplanationforSONo != null) {
                                        $('#ddlSONoStatus').val("2");
                                        $("#divSOExplanation").show();
                                        $("#divSOInstrument").show();
                                        $("#divSONo").hide();
                                        $('#divSoNumTotal').hide();
                                        $("#divSOCNo").hide();
                                        $("#divSOCNoDate").hide();
                                    }
                                    else {
                                        $('#chkMultiple').attr('checked', true);
                                        $('#TextBoxContainer').show();
                                        $('#btnAdd').show();
                                        $('#divService').hide();
                                        MultipleSONOListView(ExpenditureHeaderID);
                                    }
                                    $('#chkMultiple').attr('disabled', true);
                                    $('#txtSONo').val(headerData.ServiceOrderNo);
                                    $('#txtSOExplanation').val(headerData.ExplanationforSONo);
                                    $("#txtSONoforInstrument").val(headerData.SerialNoforInstrument);
                                    $('#SOConfirmationNo').val(headerData.ServiceOrderConfirmationNo);


                                    var ocdate = new Date(parseInt(headerData.ServiceOrderConfirmationDate.substr(6)));
                                    // format display date (e.g. 04/10/2012)
                                    var ocdisplayDate = $.datepicker.formatDate("dd/mm/yy", ocdate);

                                    $('#txtOCDate').val(ocdisplayDate);
                                    $('#txtOCDate').datepicker("update");

                                    //readonly controls
                                    $('#txtCompanyName').attr('disabled', true);
                                    $('#txtClientManagerName').attr('disabled', true);
                                    $('#txtDate').attr('disabled', true);
                                }
                            });
                        }
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(jqxhr);
                    }
                });
            }
            ExpenseListView(ExpenditureHeaderID);
        }
        else {
            //var TodayDate = $('#txtDate').val();
            //ValidateDate(TodayDate);
        }

        $('#txtOCDate, #txtOutOCDate').on('changeDate', function (e) {
            e.preventDefault();
            $(this).datepicker('hide');
        });

        //checking the expenditure is already exist or not in Leave and Expenditure
        $('#txtDate').on('changeDate', function (e) {
            e.preventDefault();
            var selectedDate = this.value;
            var TodayDate = new Date();
            if (Date.parse(e.date) <= Date.parse(TodayDate)) {
                ValidateDate(selectedDate);
            }
            else {
                $(".popupposition").fadeIn();
                $('#errormessage').text('Future Dates Not Allowed');
                $('#errormessage').show();
                $('.popupposition').delay(3000).fadeOut('slow');
                $('#txtDate').datepicker("setDate", new Date());
                $('#txtDate').datepicker("update");
            }
            $(this).datepicker('hide');
        });


        function ValidateDate(selectedDate) {
            //verifying condition
            $.ajax({
                url: '/Employee/CheckExpenditure',
                type: "GET",
                cache: false,
                data: { ExpenditureDate: selectedDate, FromPage: 'Expense' },
                success: function (data) {
                    if (data.expenditureDateInLeave == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                    }
                    else if (data.ExpendituresInBlockedList == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                    }
                    else if (data.expenditureDateInTraining == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                    }
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }

        // show/hide local and outstation expenditure based on radio button change
        $("#Localexpend").show();
        $('input[type=radio][name=optionyes]').change(function () {
            if (this.value == 'yes') {
                $("#Localexpend").show();
                $("#divLocal1").show();
                $("#Outexpend").hide();
                $("#divOutstation").hide();
                ClearLocalFields();
                $("#txtHeaderID").val('');
            }
            else if (this.value == 'no') {
                $("#Outexpend").show();
                $("#divOutstation").show();
                $("#divLocal1").hide();
                $("#Localexpend").hide();
                ClearOutStationFields();
                //var OutDate = $('#txtOutstationDate').val();
                //ValidateDate(OutDate);
                $("#txtHeaderID").val('');
            }
        });

        $('#divMobile').hide();
        $('#divInternet').hide();
        $('#chkMobile').click(function (e) {
            var vD = new Date();
            var Mobileyear = $('#yearpicker').val();
            var Mobilemonth = $('#month').val();
            var currentDay = vD.getDate();
            var chkstatus = $('#chkMobile').is(":checked")
            if (chkstatus == true) {
                $('#mbidDiv').show();
                $('#divMobile').show();
                $('#txtMobileBill').val('');
                $('#divMobileNo').show();
                $('#txtMobileNo').val('');
                $('#divMobileComment').show();
                $('#txtMobileComment').val('');
                expenditureDate = currentDay + "/" + Mobilemonth + "/" + Mobileyear;
                MobileSelect = "MobileSelected";

                CheckMobileInternet();
                ClearMobileAndInternetSelectedControls()
                $('#ClientSection').hide();
                $('#ExpenditureSection').hide();
                $('#CommentSection').hide();
                $('#divService').hide();
                $('#divBtnAddMoreExpenses').hide();
                $("#btnSave").attr('disabled', true);
            }
            else {
                MobileSelect = "";
                $('#mbidDiv').hide();
                $('#divMobile').hide();
                $('#txtMobileBill').val('');
                $('#divMobileNo').hide();
                $('#txtMobileNo').val('');
                $('#divMobileComment').hide();
                $('#txtMobileComment').val('');
                var chlstatus = $('#chkInternet').is(":checked");
                if (chlstatus == true) {
                    $('#ClientSection').hide();
                    $('#ExpenditureSection').hide();
                    $('#CommentSection').hide();
                    $('#divBtnAddMoreExpenses').hide();
                    $('#divService').hide();
                    $("#btnSave").attr('disabled', true);
                }
                else {
                    $('#ClientSection').show();
                    $('#ExpenditureSection').show();
                    $('#CommentSection').show();
                    $('#divBtnAddMoreExpenses').show();
                    $('#divService').show();
                    $("#btnSave").attr('disabled', false);
                }
            }
        });

        $('#divInternetNo').hide();
        $('#divInternetComment').hide();
        $('#chkInternet').click(function (e) {
            var vD = new Date();
            var chlstatus = $('#chkInternet').is(":checked");
            var Internetyear = $('#yearpicker').val();
            var Internetmonth = $('#month').val();
            var currentDay = vD.getDate();
            if (chlstatus == true) {
                $('#divInternet').show();
                $('#txtInternetBill').val('');
                $('#divInternetNo').show();
                $('#txtInternetDataCard').val('');
                $('#divInternetComment').show();
                $('#txtInternetComment').val('');
                expenditureDate = currentDay + "/" + Internetmonth + "/" + Internetyear;
                //MobileSelect = "";
                InternetSelect = "InternetSelected";
                CheckMobileInternet();
                ClearMobileAndInternetSelectedControls()
                $('#ClientSection').hide();
                $('#ExpenditureSection').hide();
                $('#CommentSection').hide();
                $('#divBtnAddMoreExpenses').hide();
                $("#btnSave").attr('disabled', true);
                $('#divService').hide();
            }
            else {
                InternetSelect = "";
                $('#divInternet').hide();
                $('#txtInternetBill').val('');
                $('#divInternetNo').hide();
                $('#txtInternetDataCard').val('');
                $('#divInternetComment').hide();
                $('#txtInternetComment').val('');
                var chkstatus = $('#chkMobile').is(":checked")
                if (chkstatus == true) {
                    $('#ClientSection').hide();
                    $('#ExpenditureSection').hide();
                    $('#CommentSection').hide();
                    $('#divBtnAddMoreExpenses').hide();
                    $("#btnSave").attr('disabled', true);
                    $('#divService').hide();
                }
                else {
                    $('#ClientSection').show();
                    $('#ExpenditureSection').show();
                    $('#CommentSection').show();
                    $('#divBtnAddMoreExpenses').show();
                    $("#btnSave").attr('disabled', false);
                    $('#divService').show();
                }
            }
        });



        function CheckMobileInternet() {
            $.ajax({
                url: '/Employee/CheckExpenditure',
                type: "GET",
                cache: false,
                data: { ExpenditureDate: expenditureDate, MobileCheck: MobileSelect, InternetCheck: InternetSelect, FromPage: 'Expense' },
                success: function (data) {
                    if (data.expenditureDateInLeave == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        HideMobileInternet();
                    }
                    else if (data.ExpendituresInBlockedList == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        HideMobileInternet();
                    }
                    else if (data.MobileCheckInExpenditure == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Mobile Bill Has Been Submitted For This Month , Please Select Next Month');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        ClearMobileAndInternetSelectedControls()
                    }
                    else if (data.InternetCheckInExpenditure == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Internet Bill Has Been Submitted For This Month , Please Select Next Month');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        ClearMobileAndInternetSelectedControls()
                    }
                    else if (data.expenditureDateInTraining == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        HideMobileInternet();
                    }
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }

        function ClearMobileAndInternetSelectedControls() {
            if (MobileSelect == "MobileSelected" || InternetSelect == "InternetSelected") {
                multipleCheck = $('#chkMultiple').is(":checked");
                if (multipleCheck == true) {
                    $('#TextBoxContainer').find('div').each(function () {
                        $(this).remove();
                        MultipleArrayValues = [];
                        counter--;
                    });
                }
                $('#chkMultiple').attr('checked', false);
                $('#chkMultiple').attr('disabled', false);
                $('#btnAdd').hide();
                counter = 1;
                $('#txtCompanyName').val('');
                $('#txtClientManagerName').val('');
                $('#ddlSONoStatus').val('');
                $('#ddlSONoStatus option:eq(0)').attr('selected', 'selected');
                $('#txtSONo').val('');
                $('#txtSOExplanation').val('');
                $('#txtLocalComments').val('');
                $('#SOConfirmationNo').val('');
                $('#ddlExpenditureType option:eq(0)').attr('selected', 'selected');
                $('#txtFrom').val('');
                $('#txtToLocation').val('');
                $('#txtReason').val('');
                $('#txtKms').val('');
                $('#txtAmount').val('');
                $('#txtAmount').attr('disabled', false);
                $("#expenselist").html('');
                $('#txtSONoforInstrument').val('');
                $("#txtOCDate").val('');
                $("#txtOCDate").datepicker("setDate", new Date());
            }
            else {
                $("#chkMobile").attr('checked', false);
                $('#divMobile').hide();
                $('#txtMobileBill').val('');
                $('#mbidDiv').hide();
                $('#divMobileNo').hide();
                $('#txtMobileNo').val('');
                $('#divMobileComment').hide();
                $('#txtMobileComment').val('');
                $('#divService').show();
                $('#ClientSection').show();
                $('#ExpenditureSection').show();
                $('#CommentSection').show();
                $('#divBtnAddMoreExpenses').show();
                $("#btnSave").attr('disabled', false);
                $('#chkInternet').attr('checked', false);
                $('#divInternet').hide();
                $('#txtInternetBill').val('');
                $('#divInternetNo').hide();
                $('#txtInternetDataCard').val('');
                $('#divInternetComment').hide();
                $('#txtInternetComment').val('');
                multipleCheck = $('#chkMultiple').is(":checked");
                if (multipleCheck == true) {
                    $('#TextBoxContainer').find('div').each(function () {
                        $(this).remove();
                        MultipleArrayValues = [];
                        counter--;
                    });
                }
                $('#chkMultiple').attr('checked', false);
                $('#chkMultiple').attr('disabled', false);
                $('#btnAdd').hide();
                counter = 1;
                $('#txtCompanyName').val('');
                $('#txtClientManagerName').val('');
                $('#txtDate').val('');
                $('#txtDate').datepicker("setDate", new Date());
                $('#ddlSONoStatus').val('');
                $('#ddlSONoStatus option:eq(0)').attr('selected', 'selected');
                $('#txtSONo').val('');
                $('#txtSOExplanation').val('');
                $('#txtLocalComments').val('');
                $('#SOConfirmationNo').val('');
                $('#ddlExpenditureType option:eq(0)').attr('selected', 'selected');
                $('#txtFrom').val('');
                $('#txtToLocation').val('');
                $('#txtReason').val('');
                $('#txtKms').val('');
                $('#txtAmount').val('');
                $('#txtAmount').attr('disabled', false);
                $("#expenselist").html('');
                $('#txtSONoforInstrument').val('');
                $("#txtOCDate").val('');
                $("#txtOCDate").datepicker("setDate", new Date());
            }
        }

        function HideMobileInternet() {
            $("#chkMobile").attr('checked', false);
            $('#divMobile').hide();
            $('#txtMobileBill').val('');
            $('#divMobileNo').hide();
            $('#txtMobileNo').val('');
            $('#divMobileComment').hide();
            $('#txtMobileComment').val('');
            $('#ClientSection').show();
            $('#ExpenditureSection').show();
            $('#CommentSection').show();
            $('#divBtnAddMoreExpenses').show();
            $("#btnSave").attr('disabled', false);
            $('#chkInternet').attr('checked', false);
            $('#divInternet').hide();
            $('#txtInternetBill').val('');
            $('#divInternetNo').hide();
            $('#txtInternetDataCard').val('');
            $('#divInternetComment').hide();
            $('#txtInternetComment').val('');
            $("#divSONos").html('');
            multipleCheck = $('#chkMultiple').is(":checked");
            if (multipleCheck == true) {
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            $('#chkMultiple').attr('checked', false);
            $('#chkMultiple').attr('disabled', false);
            $('#btnAdd').hide();
            counter = 1;
            $('#divService').show();
        }

        function ClearLocalFields() {
            $('#txtCompanyName').attr('disabled', false);
            $('#txtClientManagerName').attr('disabled', false);
            $('#txtDate').attr('disabled', false);
            $("#btnSave").attr('disabled', false);
            $("#chkMobile").attr('checked', false);
            $('#divMobile').hide();
            $('#txtMobileBill').val('');
            $('#chkInternet').attr('checked', false);
            $('#divInternet').hide();
            $('#txtInternetBill').val('');
            $('#chkMobile').attr('disabled', false);
            $('#chkInternet').attr('disabled', false);
            $('#txtCompanyName').val('');
            $('#txtClientManagerName').val('');
            $('#txtDate').val('');
            $('#txtDate').datepicker();
            $('#txtDate').datepicker("update");

            //$("#txtDate").datepicker("remove");

            $('#ddlSONoStatus').val('');
            $('#ddlSONoStatus option:eq(0)').attr('selected', 'selected');
            $('#txtSONo').val('');
            $('#txtSOExplanation').val('');
            $('#txtLocalComments').val('');
            $('#SOConfirmationNo').val('');
            $('#ddlExpenditureType option:eq(0)').attr('selected', 'selected');
            $('#txtFrom').val('');
            $('#txtToLocation').val('');
            $('#txtReason').val('');
            $('#txtKms').val('');
            $('#txtAmount').val('');
            $("#expenselist").html('');
            $('#txtSONoforInstrument').val('');
            $("#txtOCDate").val('');
            $("#txtOCDate").datepicker("setDate", new Date());
            $('#txtOCDate').datepicker("update");
            $('#divMobileNo').hide();
            $('#txtMobileNo').val('');
            $('#divMobileComment').hide();
            $('#txtMobileComment').val('');
            $('#divInternetNo').hide();
            $('#txtInternetDataCard').val('');
            $('#divInternetComment').hide();
            $('#txtInternetComment').val('');
            $('#divService').show();
            $('#ClientSection').show();
            $('#ExpenditureSection').show();
            $('#CommentSection').show();
            $('#divBtnAddMoreExpenses').show();
            $("#divSONos").html('');
            multipleCheck = $('#chkMultiple').is(":checked");
            if (multipleCheck == true) {
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            $('#chkMultiple').attr('checked', false);
            $('#chkMultiple').attr('disabled', false);
            $('#btnAdd').hide();
            counter = 1;
            $("#divAmount").show();
            $('input:submit').attr("disabled", false);
            $('#yearpicker').attr('disabled', false);
            $('#month').attr('disabled', false);
            $('#days').attr('disabled', false);
        }

        //hide/show so# and so explanation based on status of SO NO Local
        $('#ddlSONoStatus').change(function (e) {
            e.preventDefault();
            var statusID = $('#ddlSONoStatus').val();
            if (statusID == 2) {
                $("#divSOExplanation").show();
                $("#divSOInstrument").show();
                $("#divSONo").hide();
                $("#divSOCNo").hide();
                $("#divSOCNoDate").hide();
                $("#divSoNumTotal").hide();
                $('#txtSONo').val('');
                $('#SOConfirmationNo').val('');
                $('#txtOCDate').val('');
                $('#txtOCDate').datepicker('setDate', new Date());
                $('#txtOCDate').datepicker('update');
                $('#txtSOExplanation').val('');
                $('#txtSONoforInstrument').val('');
            }
            else {
                $("#divSOExplanation").hide();
                $("#divSOInstrument").hide();
                $("#divSONo").show();
                $("#divSOCNo").show();
                $("#divSOCNoDate").show();
                $("#divSoNumTotal").show();
                $('#txtSONo').val('');
                $('#SOConfirmationNo').val('');
                $('#txtOCDate').val('');
                $('#txtOCDate').datepicker('setDate', new Date());
                $('#txtOCDate').datepicker('update');
                $('#txtSOExplanation').val('');
                $('#txtSONoforInstrument').val('');
            }
        });

        //get conveyance from employee based on change the expenditure type in local part
        $('#ddlExpenditureType').change(function (e) {
            e.preventDefault();
            var statusID = $('#ddlExpenditureType option:selected').text();
            if (statusID == "Bike") {
                $("#LocFrom").show();
                $('#txtFrom').val('');
                $('#txtToLocation').val('');
                $("#divLocTo").show();
                $("#divConveyance").hide();
                $("#divReason").hide();
                $("#divKm").show();
                $("#divAmount").show();
                $("#txtKms").val('');
                $("#txtAmount").val('');
                $("#txtAmount").attr('disabled', true);
            }
            else if (statusID == "Other") {
                $("#divReason").show();
                $('#txtReason').val('');
                $("#LocFrom").hide();
                $("#divLocTo").hide();
                $("#divKm").hide();
                $("#divConveyance").hide();
                $("#divAmount").show();
                $("#txtAmount").attr('disabled', false);
                $("#txtKms").val('');
                $("#txtAmount").val('');
            }
            else if (statusID == "Car") {
                Conveyance = $('#txtConveyanceValue').val();
                if (Conveyance > 0) {
                    $("#LocFrom").show();
                    $("#divLocTo").show();
                    $("#divKm").show();
                    $("#divReason").hide();
                    $("#divAmount").show();
                    $("#txtAmount").attr('disabled', true);
                    $("#txtKms").val('');
                    $("#txtAmount").val('');
                }
                else {
                    $("#LocFrom").show();
                    $("#divLocTo").show();
                    $("#divKm").show();
                    $("#divReason").hide();
                    $("#divAmount").hide();
                    $("#txtAmount").attr('disabled', false);
                    $("#txtKms").val('');
                    $("#txtAmount").val('');
                }
            }
            else {
                $("#LocFrom").show();
                $('#txtFrom').val('');
                $('#txtToLocation').val('');
                $("#divLocTo").show();
                $("#divConveyance").hide();
                $("#divReason").hide();
                $("#divKm").hide();
                $("#divAmount").show();
                $("#txtAmount").attr('disabled', false);
                $("#txtKms").val('');
                $("#txtAmount").val('');
            }
        });

        //calculate the amount when enter the kms and selection of expenditure type bike
        $('#txtKms').change(function (e) {
            e.preventDefault();
            var txtKMS = $("#txtKms").val();
            Conveyance = $('#txtConveyanceValue').val();
            var statusID = $('#ddlExpenditureType option:selected').text();
            if (Conveyance > 0 && statusID == "Bike") {
                var totalamount = txtKMS * Conveyance;
                $('#txtAmount').val(totalamount);
            }
            else if (Conveyance > 0 && statusID == "Car") {
                var totalamount = txtKMS * Conveyance;
                $('#txtAmount').val(totalamount);
            }
        });

        //local submittion
        $("#btnLocalAdd").click(function (e) {
            $("#btnLocalAdd").attr('disabled', true);
            $('#yearpicker').attr('disabled', true);
            $('#month').attr('disabled', true);
            $('#days').attr('disabled', true);
            e.preventDefault();
            expenditureDate = $('#txtDate').val();
            ClientName = $('#txtCompanyName').val();
            ClientManagerName = $("#txtClientManagerName option:selected").text();
            ClientManagerStatus = $("#txtClientManagerName").val();
            SOServiceStatus = $('#ddlSONoStatus').val();
            SONo = $('#txtSONo').val();
            SOExplanation = $('#txtSOExplanation').val();
            OrderConfirmationNo = $('#SOConfirmationNo').val();
            ExpenditureType = $('#ddlExpenditureType option:selected').text();
            Conveyance = $('#txtConveyanceValue').val();
            FromLocation = $('#txtFrom').val();
            ToLocation = $('#txtToLocation').val();
            Reason = $("#txtReason").val();
            Kms = $('#txtKms').val();
            Amount = $('#txtAmount').val();
            comments = $('#txtLocalComments').val();
            SONoInstruments = $('#txtSONoforInstrument').val();
            OrderConfirmationDate = $('#txtOCDate').val();
            ExpenditureHeaderID = $('#txtHeaderID').val();
            var date = new Date();
            var ddlmultiCount;
            var eachCount;
            multipleCheck = $('#chkMultiple').is(":checked");
            if (multipleCheck == true) {
                ddlmultiCount = $(".ddlMultiStatus").length;
                eachCount = 0;
                $(".ddlMultiStatus").each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                $("#btnLocalAdd").attr('disabled', false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            $("#btnLocalAdd").attr('disabled', false);
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {
                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', MultiSOCD)) {
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                                $("#btnLocalAdd").attr('disabled', false);
                                                return false;
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            $("#btnLocalAdd").attr('disabled', false);
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        $("#btnLocalAdd").attr('disabled', false);
                                        return false;
                                    }
                                }
                                else {
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                $("#btnLocalAdd").attr('disabled', false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            $("#btnLocalAdd").attr('disabled', false);
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        this.focus();
                        $("#btnLocalAdd").attr('disabled', false);
                        return false;
                    }
                    eachCount++;
                });

                MultipleArrayValues = [];
                if (eachCount == ddlmultiCount) {
                    if (expenditureDate.length > 0) {
                        //date condition check if today or below today to allow expenditure submittion else select valid date
                        if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                            //validate client Name
                            if (ClientName.length > 0) {
                                //validate client Manager Name
                                if (ClientManagerStatus > 0) {
                                    var SCONOS = 1;
                                    $('.Multiple').each(function () {
                                        var values = [];
                                        var List = 1;
                                        $(this).find('input[type=text]').each(function (e) {
                                            var item = {
                                                "Id": this.name + SCONOS,
                                                "Value": $(this).val()
                                            };
                                            values.push(item)
                                            List++;
                                        });

                                        MultipleArrayValues.push(values);
                                        SCONOS++;
                                    });
                                    if (MultipleArrayValues.length > 0) {
                                        FromExpenditureType();
                                        $("#chkMultiple").attr('disabled', true);
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Add Multiple Service Order Nos and Fill Appropriate Details');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnAdd").focus();
                                        $("#btnLocalAdd").attr('disabled', false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Select Client Manager');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#txtClientManagerName").focus();
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Company Name');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtCompanyName').focus();
                                $("#btnLocalAdd").attr('disabled', false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Future Dates Not Allowed');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtDate').focus();
                            $("#btnLocalAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $("#btnLocalAdd").attr('disabled', false);
                    }
                }
            }
            else {
                if (expenditureDate.length > 0) {
                    //date condition check if today or below today to allow expenditure submittion else select valid date
                    if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                        if (ClientName.length > 0) {
                            if (ClientManagerStatus > 0) {
                                //validate the value selection from SO No Status and forwarded to appropriate sections
                                if (SOServiceStatus == 0) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Select Service Order Status');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#ddlSONoStatus').focus();
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                                else if (SOServiceStatus == 1) {
                                    if (SONo.length > 0) {
                                        if (SONo.length >= 10 && SONo.length <= 15) {
                                            if (OrderConfirmationNo.length > 0) {
                                                if (OrderConfirmationNo.length >= 10 && OrderConfirmationNo.length <= 15) {
                                                    if (OrderConfirmationDate.length > 0) {
                                                        if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', OrderConfirmationDate)) {
                                                            FromExpenditureType();
                                                        }
                                                        else {
                                                            $(".popupposition").fadeIn();
                                                            $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                            $('#errormessage').show();
                                                            $('.popupposition').delay(3000).fadeOut('slow');
                                                            $('#txtOCDate').focus();
                                                            $("#btnLocalAdd").attr('disabled', false);
                                                        }
                                                    }
                                                    else {
                                                        $(".popupposition").fadeIn();
                                                        $('#errormessage').text('Please Select SO Confirmation Date');
                                                        $('#errormessage').show();
                                                        $('.popupposition').delay(3000).fadeOut('slow');
                                                        $('#txtOCDate').focus();
                                                        $("#btnLocalAdd").attr('disabled', false);
                                                    }
                                                }
                                                else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#SOConfirmationNo').focus();
                                                    $("#btnLocalAdd").attr('disabled', false);
                                                }
                                            }
                                            else {
                                                FromExpenditureType();
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('#txtSONo').focus();
                                            $("#btnLocalAdd").attr('disabled', false);
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Enter SO No');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtSONo').focus();
                                        $("#btnLocalAdd").attr('disabled', false);
                                    }
                                }
                                else if (SOServiceStatus == 2) {
                                    if (SOExplanation.length > 0) {
                                        if (SONoInstruments.length > 0) {
                                            FromExpenditureType();
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Enter Serial Number for Instrument');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $("#btnLocalAdd").attr('disabled', false);
                                            $('#txtSONoforInstrument').focus();
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Enter SO No Explanation');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnLocalAdd").attr('disabled', false);
                                        $('#txtSOExplanation').focus();
                                    }
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Select Client Manager');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $("#txtClientManagerName").focus();
                                $("#btnLocalAdd").attr('disabled', false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter Company Name');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtCompanyName').focus();
                            $("#btnLocalAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Future Dates Not Allowed');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $("#btnLocalAdd").attr('disabled', false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Date');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtDate').focus();
                    $("#btnLocalAdd").attr('disabled', false);
                }
            }
        });

        function FromExpenditureType() {
            $('#chkMultiple').attr('disabled', true);
            MobileID = "Mobile Bill";
            InternetID = "Internet Bill";
            //validate expenditure type
            if (ExpenditureType == 'Select') {
                if (Mobile.length > 0 || Internet.length > 0) {
                    if (ExpenditureHeaderID > 0) {
                        InsertExpenditure();
                    }
                    else {
                        $.ajax({
                            url: '/Employee/CheckExpenditure',
                            type: "GET",
                            data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                            success: function (data) {
                                if (data.expenditureDateInLeave == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                                else if (data.ExpendituresInBlockedList == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                                else if (data.expenditureDateInTraining == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                                else {
                                    Localization = "Local";
                                    InsertExpenditure();
                                }
                            },
                            error: function (event, jqxhr, settings, exception) {
                                alert(exception);
                            }
                        });
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Expenditure Type');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#ddlExpenditureType').focus();
                    $("#btnLocalAdd").attr('disabled', false);
                }
            }
            //section select expenditure type OTHER
            else if (ExpenditureType == 'Other') {
                //from other selection and reason validate
                if (Reason.length > 0) {
                    //validate Amount
                    if (Amount.length > 0) {
                        if (ExpenditureHeaderID > 0) {
                            InsertExpenditure();
                        }
                        else {
                            $.ajax({
                                url: '/Employee/CheckExpenditure',
                                type: "GET",
                                data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                success: function (data) {
                                    if (data.expenditureDateInLeave == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnLocalAdd").attr('disabled', false);
                                    }
                                    else if (data.ExpendituresInBlockedList == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnLocalAdd").attr('disabled', false);
                                    }
                                    else if (data.expenditureDateInTraining == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnLocalAdd").attr('disabled', false);
                                    }
                                    else {
                                        Localization = "Local";
                                        InsertExpenditure();
                                    }
                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter Amount');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtAmount').focus();
                        $("#btnLocalAdd").attr('disabled', false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Enter Expense Details');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $("#btnLocalAdd").attr('disabled', false);
                    $("#txtReason").focus();
                }
            }
            else {
                //validate from location when select car and bike
                if (FromLocation.length > 0) {
                    //validate to location when select car and bike
                    if (ToLocation.length > 0) {
                        //validate kms when select car and bike
                        if (Kms.length > 0) {
                            if (Conveyance.length > 0) {
                                if (ExpenditureHeaderID > 0) {
                                    InsertExpenditure();
                                }
                                else {
                                    $.ajax({
                                        url: '/Employee/CheckExpenditure',
                                        type: "GET",
                                        data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                        success: function (data) {
                                            if (data.expenditureDateInLeave == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $("#btnLocalAdd").attr('disabled', false);
                                            }
                                            else if (data.ExpendituresInBlockedList == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $("#btnLocalAdd").attr('disabled', false);
                                            }
                                            else if (data.expenditureDateInTraining == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $("#btnLocalAdd").attr('disabled', false);
                                            }
                                            else {
                                                Localization = "Local";
                                                InsertExpenditure();
                                            }
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                }
                            }
                            else {
                                //validate amount when select car and bike
                                if (Amount.length > 0) {
                                    if (ExpenditureHeaderID > 0) {
                                        InsertExpenditure();
                                    }
                                    else {
                                        $.ajax({
                                            url: '/Employee/CheckExpenditure',
                                            type: "GET",
                                            data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                            success: function (data) {
                                                if (data.expenditureDateInLeave == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $("#btnLocalAdd").attr('disabled', false);
                                                }
                                                else if (data.ExpendituresInBlockedList == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $("#btnLocalAdd").attr('disabled', false);
                                                }
                                                else if (data.expenditureDateInTraining == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $("#btnLocalAdd").attr('disabled', false);
                                                }
                                                else {
                                                    Localization = "Local";
                                                    InsertExpenditure();
                                                }
                                            },
                                            error: function (event, jqxhr, settings, exception) {
                                                alert(exception);
                                            }
                                        });
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter Amount');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtAmount').focus();
                                    $("#btnLocalAdd").attr('disabled', false);
                                }
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter Kms');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtKms').focus();
                            $("#btnLocalAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter To Location');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtToLocation').focus();
                        $("#btnLocalAdd").attr('disabled', false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Enter From Location');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtFrom').focus();
                    $("#btnLocalAdd").attr('disabled', false);
                }
            }
        }

        // Insert Expenditure
        function InsertExpenditure() {
            ExpenditureHeaderID = $('#txtHeaderID').val();
            if (ExpenditureHeaderID > 0) {
                if (multipleCheck == true) {
                    $.ajax({
                        url: '/Employee/MultipleServiceOrders',
                        type: "POST",
                        dataType: 'json',
                        data: { FormData: JSON.stringify(MultipleArrayValues), ExpenseDate: expenditureDate, ClientName: ClientName,
                            From: FromLocation, To: ToLocation, ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                            ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance, Localization: Localization,
                            ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments
                        },
                        success: function (data) {
                            if (Localization == "Outstation") {
                                OutstationControls();
                            }
                            else {
                                LocalControls();
                            }
                            ExpenseListView(ExpenditureHeaderID);
                            MultipleSONOListView(ExpenditureHeaderID);
                        },
                        error: function (event, jqxhr, settings, exception) {
                            alert(exception);
                        }
                    });
                }
                else {
                    $.ajax({
                        url: '/Employee/LocalExpenditure',
                        type: "POST",
                        data: { ExpenseDate: expenditureDate, ClientName: ClientName, ServiceOrderNumber: SONo,
                            OrderConfirmationNo: OrderConfirmationNo,
                            From: FromLocation, To: ToLocation,
                            ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                            SOExplanation: SOExplanation, ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance,
                            Localization: Localization, ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments, Mobile: Mobile, MobileTypeID: MobileID, Internet: Internet, InternetID: InternetID, SerialNoInstrument: SONoInstruments, OrderConfirmationDate: OrderConfirmationDate, MobileNo: MobileNo, MobileComment: MobileComment, InternetNo: InternetNo, InternetComment: InternetComment
                        },
                        dataType: 'json',
                        success: function (data) {
                            if (Localization == "Outstation") {
                                OutstationControls();
                            }
                            else {
                                LocalControls();
                            }
                            ExpenseListView(ExpenditureHeaderID);
                        },
                        error: function (event, jqxhr, settings, exception) {
                            alert(exception);
                        }
                    });
                }
            }
            else {
                if (multipleCheck == true) {
                    $.ajax({
                        url: '/Employee/MultipleServiceOrders',
                        type: "POST",
                        dataType: 'json',
                        data: { FormData: JSON.stringify(MultipleArrayValues), ExpenseDate: expenditureDate, ClientName: ClientName,
                            From: FromLocation, To: ToLocation, ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                            ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance, Localization: Localization,
                            ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments
                        },
                        success: function (data) {
                            $('#txtHeaderID').val(data);
                            ExpenditureHeaderID = data;
                            if (Localization == "Outstation") {
                                OutstationControls();
                            }
                            else {
                                LocalControls();
                            }
                            ExpenseListView(ExpenditureHeaderID);

                            MultipleSONOListView(ExpenditureHeaderID);
                        },
                        error: function (event, jqxhr, settings, exception) {
                            alert(exception);
                        }
                    });
                }
                else {
                    $.ajax({
                        url: '/Employee/LocalExpenditure',
                        type: "POST",
                        data: { ExpenseDate: expenditureDate, ClientName: ClientName, ServiceOrderNumber: SONo,
                            OrderConfirmationNo: OrderConfirmationNo,
                            From: FromLocation, To: ToLocation,
                            ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                            SOExplanation: SOExplanation, ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance,
                            Localization: Localization, ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments, Mobile: Mobile, MobileTypeID: MobileID, Internet: Internet, InternetID: InternetID, SerialNoInstrument: SONoInstruments, OrderConfirmationDate: OrderConfirmationDate, MobileNo: MobileNo, MobileComment: MobileComment, InternetNo: InternetNo, InternetComment: InternetComment
                        },
                        dataType: 'json',
                        success: function (data) {
                            $('#txtHeaderID').val(data);
                            ExpenditureHeaderID = data;
                            if (Localization == "Outstation") {
                                OutstationControls();
                            }
                            else {
                                LocalControls();
                            }
                            ExpenseListView(ExpenditureHeaderID);
                        },
                        error: function (event, jqxhr, settings, exception) {
                            alert(exception);
                        }
                    });
                }
            }
        }

        function OutstationControls() {
            $('#txtOutstationDate').attr('disabled', true);
            $('#txtOutClientName').attr('disabled', true);
            $('#txtOutClientManagerName').attr('disabled', true);

            $('#yearpicker').attr('disabled', true);
            $('#month').attr('disabled', true);
            $('#days').attr('disabled', true);

            $('#txtOutFrom').val('');
            $('#txtOutToLocation').val('');
            $('#txtOutAmount').val('');
            $('#ddlOutExpenditureType option:eq(0)').attr('selected', 'selected');
            $('#ddlOutExpenditureTypeDetail').empty();
            $('#ddlOutExpenditureTypeDetail').append('<option value="0">Select Expenditure Type Details</option');
            $('#txtOutReason').val('');
            $('#divOutReason').hide();
            $('#txtComments').val('');
            $("#chkOutMobile").attr('checked', false);
            $('#divOutMobile').hide();
            $('#txtOutMobileBill').val('');
            $('#chkOutInternet').attr('checked', false);
            $('#divOutInternet').hide();
            $('#txtOutInternetBill').val('');
            $('#divOutFrom').show();
            $('#txtOutFrom').val('');
            $('#divOutTo').show();
            $('#txtOutToLocation').val('');
            $('#divOutInternetNo').hide();
            $('#txtOutInternetNo').val('');
            $('#divOutInternetComment').hide();
            $('#txtOutInternetComment').val('');
            $('#divOutMobileNo').hide();
            $('#txtOutMobileNo').val('');
            $('#divOutMobileComment').hide();
            $('#txtOutMobileComment').val('');
            MultipleArrayValues = [];
            if (multipleCheck == true) {
                $('#TextBoxContainerForOut').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            counter = 1;
            $("#btnOutAdd").attr('disabled', false);
        }

        function LocalControls() {
            $('#txtCompanyName').attr('disabled', true);
            $('#txtClientManagerName').attr('disabled', true);
            $('#txtDate').attr('disabled', true);
            $('#ddlExpenditureType option:eq(0)').attr('selected', 'selected');
            $('#txtFrom').val('');
            $('#txtToLocation').val('');
            $('#txtReason').val('');
            $('#txtKms').val('');
            $('#txtAmount').val('');
            $('#txtAmount').attr('disabled', false);
            $("#divConveyance").hide();
            $('#txtLocalComments').val('');
            $("#chkMobile").attr('checked', false);
            $('#divMobile').hide();
            $('#txtMobileBill').val('');
            $('#chkInternet').attr('checked', false);
            $('#divInternet').hide();
            $('#txtInternetBill').val('');
            $('#divMobileNo').hide();
            $('#txtMobileNo').val('');
            $('#divMobileComment').hide();
            $('#txtMobileComment').val('');
            $('#divInternetNo').hide();
            $('#txtInternetDataCard').val('');
            $('#divInternetComment').hide();
            $('#txtInternetComment').val('');
            $('#txtOCDate').datepicker("update");
            $('#txtDate').datepicker("update");
            MultipleArrayValues = [];
            if (multipleCheck == true) {
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            counter = 1;
            $("#divAmount").show();
            $("#btnLocalAdd").attr('disabled', false);
        }

        //list view for submitted expenditure details
        function ExpenseListView(ExpenditureHeaderID) {
            $.ajax({
                url: '/Employee/ExpenseListByID',
                cache: false,
                type: "GET",
                data: { Data: ExpenditureHeaderID },
                dataType: 'html',
                success: function (data) {
                    $("#expenselist").html('');
                    $("#expenselist").html(data);
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }

        function MultipleSONOListView(ExpenditureHeaderID) {
            $.ajax({
                url: '/Employee/MultipleSONos',
                type: "POST",
                cache: false,
                data: { Data: ExpenditureHeaderID },
                dataType: 'html',
                success: function (data) {
                    $("#divSONos").html('');
                    $("#divSONos").html(data);
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }

        $("#btnReset").click(function (e) {
            e.preventDefault();
            $('#txtCompanyName').attr('disabled', false);
            $('#txtClientManagerName').attr('disabled', false);
            $('#txtDate').attr('disabled', false);
            $("#btnSubmit").attr('disabled', false);
            $("#btnLocalAdd").attr('disabled', false);
            $("#chkMobile").attr('checked', false);

            $('#yearpicker').attr('disabled', false);
            $('#month').attr('disabled', false);
            $('#days').attr('disabled', false);

            $('#divMobile').hide();
            $('#txtMobileBill').val('');
            $('#chkInternet').attr('checked', false);
            $('#divInternet').hide();
            $('#txtInternetBill').val('');
            $('#txtCompanyName').val('');
            $('#txtClientManagerName option:eq(0)').attr('selected', 'selected');
            $('#txtDate').val('');
            $('#txtDate').datepicker();
            $('#txtDate').datepicker("update");
            //            $("#txtDate").datepicker("remove");
            $('#ddlSONoStatus').val('');
            $('#ddlSONoStatus option:eq(0)').attr('selected', 'selected');
            $('#txtSONo').val('');
            $('#txtSOExplanation').val('');
            $('#txtLocalComments').val('');
            $('#SOConfirmationNo').val('');
            $('#ddlExpenditureType option:eq(0)').attr('selected', 'selected');
            $('#txtFrom').val('');
            $('#txtToLocation').val('');
            $('#txtReason').val('');
            $('#txtKms').val('');
            $('#txtAmount').val('');
            $("#expenselist").html('');
            $('#txtHeaderID').val('');
            $('#divSOInstrument').hide();
            $('#txtSONoforInstrument').val('');
            $('#txtOCDate').val('');
            $('#txtOCDate').datepicker("setDate", new Date());
            $('#txtOCDate').datepicker("update");
            $('#divMobileNo').hide();
            $('#txtMobileNo').val('');
            $('#divMobileComment').hide();
            $('#txtMobileComment').val('');
            $('#divInternetNo').hide();
            $('#txtInternetDataCard').val('');
            $('#divInternetComment').hide();
            $('#txtInternetComment').val('');
            $('#ClientSection').show();
            $('#ExpenditureSection').show();
            $('#CommentSection').show();
            $('#divBtnAddMoreExpenses').show();
            $("#btnSave").attr('disabled', false);
            $('#chkMobile').attr('disabled', false);
            $('#chkInternet').attr('disabled', false);
            $('#chkMultiple').attr('checked', false);
            $('#chkMultiple').attr('disabled', false);
            $('#btnAdd').hide();
            $('#divService').show();
            $("#divSONo").show();
            $('#divSoNumTotal').show();
            $('#divSOCNo').show();
            $("#divSOCNoDate").show();
            $('#divSOExplanation').hide();
            $('#divSOInstrument').hide();
            $("#txtAmount").attr('disabled', false);
            $('#TextBoxContainer').hide();
            $("#divSONos").html('');
            multipleCheck = $('#chkMultiple').is(":checked");
            if (multipleCheck == false) {
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            else {
                $('#TextBoxContainer').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            $('#chkMultiple').attr('checked', false);
            counter = 1;
            $("#divAmount").show();
        });

        $("#btnSave").click(function (e) {
            e.preventDefault();
            $('input:submit').attr("disabled", true);
            ExpenditureHeaderID = $('#txtHeaderID').val();
            if (ExpenditureHeaderID > 0) {
                SONo = $('#txtSONo').val();
                OrderConfirmationNo = $('#SOConfirmationNo').val();
                OrderConfirmationDate = $('#txtOCDate').val();
                SOExplanation = $('#txtSOExplanation').val();
                SONoInstruments = $('#txtSONoforInstrument').val();
                $.ajax({
                    url: '/Employee/ExpenditureListClose',
                    type: "POST",
                    data: { HeaderID: ExpenditureHeaderID, SONo: SONo, OrderConfirmationNo: OrderConfirmationNo, OrderConfirmationDate: OrderConfirmationDate, SOExplanation: SOExplanation, FromStatus: 'false', SerialNoInstrument: SONoInstruments },
                    success: function (data) {
                        $(".popuppositionsucess").fadeIn();
                        $('#sucessresult').text('Your Expenditure Saved Successfully');
                        $('#sucessresult').show();
                        $('.popuppositionsucess').delay(3000).fadeOut('slow');
                        ClearLocalFields();
                        $('#txtHeaderID').val('');
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
            else {

                FromStatus = false;
                SingleSubmission();
            }
        });

        function SingleSubmission() {
            expenditureDate = $('#txtDate').val();
            var chkInternet = $('#chkInternet').is(":checked");
            Internet = $('#txtInternetBill').val();
            var chkMobile = $('#chkMobile').is(":checked");
            Mobile = $('#txtMobileBill').val();
            ClientName = $('#txtCompanyName').val();
            ClientManagerStatus = $("#txtClientManagerName").val();
            ClientManagerName = $("#txtClientManagerName option:selected").text();
            SOServiceStatus = $('#ddlSONoStatus').val();
            SONo = $('#txtSONo').val();
            SOExplanation = $('#txtSOExplanation').val();
            OrderConfirmationNo = $('#SOConfirmationNo').val();
            ExpenditureType = $('#ddlExpenditureType option:selected').text();
            Conveyance = $('#txtConveyanceValue').val();
            FromLocation = $('#txtFrom').val();
            ToLocation = $('#txtToLocation').val();
            Reason = $("#txtReason").val();
            Kms = $('#txtKms').val();
            Amount = $('#txtAmount').val();
            comments = $('#txtLocalComments').val();
            ExpenditureHeaderID = $('#txtHeaderID').val();
            SONoInstruments = $('#txtSONoforInstrument').val();
            OrderConfirmationDate = $('#txtOCDate').val();
            MobileNo = $('#txtMobileNo').val();
            MobileComment = $('#txtMobileComment').val();
            InternetNo = $('#txtInternetDataCard').val();
            InternetComment = $('#txtInternetComment').val();
            var date = new Date();
            var ddlmultiCount;
            var eachCount;
            MultipleArrayValues = [];
            multipleCheck = $('#chkMultiple').is(":checked");
            if (multipleCheck == true) {
                ddlmultiCount = $(".ddlMultiStatus").length;
                eachCount = 0;
                $(".ddlMultiStatus").each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                $('input:submit').attr("disabled", false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            $('input:submit').attr("disabled", false);
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {
                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', MultiSOCD)) {
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                                $('input:submit').attr("disabled", false);
                                                return false;
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            $('input:submit').attr("disabled", false);
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        $('input:submit').attr("disabled", false);
                                        return false;
                                    }
                                }
                                else {
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                $('input:submit').attr("disabled", false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            $('input:submit').attr("disabled", false);
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        this.focus();
                        $('input:submit').attr("disabled", false);
                        return false;
                    }
                    eachCount++;
                });

                if (eachCount == ddlmultiCount) {
                    if (expenditureDate.length > 0) {
                        //date condition check if today or below today to allow expenditure submittion else select valid date
                        if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                            //validate client Name
                            if (ClientName.length > 0) {
                                //validate client Manager Name
                                if (ClientManagerStatus > 0) {
                                    var SCONOS = 1;
                                    $('.Multiple').each(function () {
                                        var values = [];
                                        var List = 1;
                                        $(this).find('input[type=text]').each(function (e) {
                                            var item = {
                                                "Id": this.name + SCONOS,
                                                "Value": $(this).val()
                                            };
                                            values.push(item)
                                            List++;
                                        });

                                        MultipleArrayValues.push(values);
                                        SCONOS++;
                                    });

                                    if (MultipleArrayValues.length > 0) {
                                        if (eachCount > 1) {
                                            FromSaveSubmit();
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Add At-least two Multiple Service Order Nos/Uncheck Multiple CheckBox');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $("#btnOutAddSONOs").focus();
                                            $('input:submit').attr("disabled", false);
                                        }

                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Add Multiple Service Order Nos and Fill Appropriate Details');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnOutAddSONOs").focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Select Client Manager');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#txtClientManagerName").focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Company Name');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtCompanyName').focus();
                                $('input:submit').attr("disabled", false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Future Dates Not Allowed');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtDate').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
            }
            else {
                if (expenditureDate.length > 0) {
                    //date condition check if today or below today to allow expenditure submittion else select valid date
                    if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                        if (chkInternet == true) {
                            if (InternetNo.length > 0) {
                                if (InternetNo.length == 10) {
                                    if (Internet.length > 0) {
                                        if (InternetComment.length > 0) {
                                            if (chkMobile == true) {
                                                if (MobileNo.length > 0) {
                                                    if (MobileNo.length == 10) {
                                                        //validate mobile Amount
                                                        if (Mobile.length > 0) {
                                                            if (MobileComment.length > 0) {
                                                                FromSaveSubmit();
                                                            }
                                                            else {
                                                                $(".popupposition").fadeIn();
                                                                $('#errormessage').text('Please Enter Comment For Mobile');
                                                                $('#errormessage').show();
                                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                                $('#txtMobileComment').focus();
                                                                $('input:submit').attr("disabled", false);
                                                            }
                                                        }
                                                        else {
                                                            $(".popupposition").fadeIn();
                                                            $('#errormessage').text('Please Enter Mobile Bill');
                                                            $('#errormessage').show();
                                                            $('.popupposition').delay(3000).fadeOut('slow');
                                                            $('#txtMobileBill').focus();
                                                            $('input:submit').attr("disabled", false);
                                                        }
                                                    }
                                                    else {
                                                        $(".popupposition").fadeIn();
                                                        $('#errormessage').text('Mobile No Must Be 10 Digits');
                                                        $('#errormessage').show();
                                                        $('.popupposition').delay(3000).fadeOut('slow');
                                                        $('#txtMobileNo').focus();
                                                        $('input:submit').attr("disabled", false);
                                                    }
                                                }
                                                else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Please Enter Mobile No');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#txtMobileNo').focus();
                                                    $('input:submit').attr("disabled", false);
                                                }
                                            }
                                            else {
                                                FromSaveSubmit();
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Enter Comment For Internet');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('#txtInternetComment').focus();
                                            $('input:submit').attr("disabled", false);
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Enter Internet Bill');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtInternetBill').focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Data Card No Must Be 10 Digits');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtInternetDataCard').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Data Card No');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtInternetDataCard').focus();
                                $('input:submit').attr("disabled", false);
                            }
                        }
                        else {
                            if (chkMobile == true) {
                                if (MobileNo.length > 0) {
                                    if (MobileNo.length == 10) {
                                        //validate mobile Amount
                                        if (Mobile.length > 0) {
                                            if (MobileComment.length > 0) {
                                                FromSaveSubmit();
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Please Enter Comment For Mobile');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('#txtMobileComment').focus();
                                                $('input:submit').attr("disabled", false);
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Enter Mobile Bill');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('#txtMobileBill').focus();
                                            $('input:submit').attr("disabled", false);
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Mobile No Must Be 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtMobileNo').focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter Mobile No');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtMobileNo').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                            else {
                                //validate client Name
                                if (ClientName.length > 0) {
                                    //validate client Manager Name
                                    if (ClientManagerStatus > 0) {
                                        //validate the value selection from SO No Status and forwarded to appropriate sections
                                        if (SOServiceStatus == 0) {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select Service Order Status');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('#ddlSONoStatus').focus();
                                            $('input:submit').attr("disabled", false);
                                        }
                                        //section SO No value 1
                                        else if (SOServiceStatus == 1) {
                                            //validate SO No
                                            if (SONo.length > 0) {
                                                if (SONo.length >= 10 && SONo.length <= 15) {
                                                    if (OrderConfirmationNo.length > 0) {
                                                        if (OrderConfirmationNo.length >= 10 && OrderConfirmationNo.length <= 15) {
                                                            if (OrderConfirmationDate.length > 0) {
                                                                if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', OrderConfirmationDate)) {
                                                                    //validate InternetChk or Not
                                                                    if (chkInternet == true) {
                                                                        //validate Internet Amount
                                                                        if (Internet.length > 0) {
                                                                            if (chkMobile == true) {
                                                                                if (Mobile.length > 0) {
                                                                                    FromSaveSubmit();
                                                                                }
                                                                                else {
                                                                                    $(".popupposition").fadeIn();
                                                                                    $('#errormessage').text('Please Enter Mobile Bill');
                                                                                    $('#errormessage').show();
                                                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                                                    $('#txtMobileBill').focus();
                                                                                    $('input:submit').attr("disabled", false);
                                                                                }
                                                                            }
                                                                            else {
                                                                                FromSaveSubmit();
                                                                            }
                                                                        }
                                                                        else {
                                                                            $(".popupposition").fadeIn();
                                                                            $('#errormessage').text('Please Enter Internet Bill');
                                                                            $('#errormessage').show();
                                                                            $('.popupposition').delay(3000).fadeOut('slow');
                                                                            $('#txtInternetBill').focus();
                                                                            $('input:submit').attr("disabled", false);
                                                                        }
                                                                    }
                                                                    else {
                                                                        if (chkMobile == true) {
                                                                            if (Mobile.length > 0) {
                                                                                FromSaveSubmit();
                                                                            }
                                                                            else {
                                                                                $(".popupposition").fadeIn();
                                                                                $('#errormessage').text('Please Enter Mobile Bill');
                                                                                $('#errormessage').show();
                                                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                                                $('#txtMobileBill').focus();
                                                                                $('input:submit').attr("disabled", false);
                                                                            }
                                                                        }
                                                                        else {
                                                                            FromSaveSubmit();
                                                                        }
                                                                    }
                                                                }
                                                                else {
                                                                    $(".popupposition").fadeIn();
                                                                    $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                                    $('#errormessage').show();
                                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                                    $('#txtOCDate').focus();
                                                                    $('input:submit').attr("disabled", false);
                                                                }
                                                            }
                                                            else {
                                                                $(".popupposition").fadeIn();
                                                                $('#errormessage').text('Please Select SO Confirmation Date');
                                                                $('#errormessage').show();
                                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                                $('#txtOCDate').focus();
                                                                $('input:submit').attr("disabled", false);
                                                            }
                                                        }
                                                        else {
                                                            $(".popupposition").fadeIn();
                                                            $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                                            $('#errormessage').show();
                                                            $('.popupposition').delay(3000).fadeOut('slow');
                                                            $('#SOConfirmationNo').focus();
                                                            $('input:submit').attr("disabled", false);
                                                        }
                                                    }
                                                    else {
                                                        //validate InternetChk or Not
                                                        if (chkInternet == true) {
                                                            //validate Internet Amount
                                                            if (Internet.length > 0) {
                                                                if (chkMobile == true) {
                                                                    if (Mobile.length > 0) {
                                                                        FromSaveSubmit();
                                                                    }
                                                                    else {
                                                                        $(".popupposition").fadeIn();
                                                                        $('#errormessage').text('Please Enter Mobile Bill');
                                                                        $('#errormessage').show();
                                                                        $('.popupposition').delay(3000).fadeOut('slow');
                                                                        $('#txtMobileBill').focus();
                                                                        $('input:submit').attr("disabled", false);
                                                                    }
                                                                }
                                                                else {
                                                                    FromSaveSubmit();
                                                                }
                                                            }
                                                            else {
                                                                $(".popupposition").fadeIn();
                                                                $('#errormessage').text('Please Enter Internet Bill');
                                                                $('#errormessage').show();
                                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                                $('#txtInternetBill').focus();
                                                                $('input:submit').attr("disabled", false);
                                                            }
                                                        }
                                                        else {
                                                            if (chkMobile == true) {
                                                                if (Mobile.length > 0) {
                                                                    FromSaveSubmit();
                                                                }
                                                                else {
                                                                    $(".popupposition").fadeIn();
                                                                    $('#errormessage').text('Please Enter Mobile Bill');
                                                                    $('#errormessage').show();
                                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                                    $('#txtMobileBill').focus();
                                                                    $('input:submit').attr("disabled", false);
                                                                }
                                                            }
                                                            else {
                                                                FromSaveSubmit();
                                                            }
                                                        }
                                                    }
                                                }
                                                else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#txtSONo').focus();
                                                    $('input:submit').attr("disabled", false);
                                                }
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Please Enter SO No');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('#txtSONo').focus();
                                                $('input:submit').attr("disabled", false);
                                            }
                                        }
                                        else if (SOServiceStatus == 2) {
                                            if (SOExplanation.length > 0) {
                                                //validate instrument number
                                                if (SONoInstruments.length > 0) {
                                                    //validate InternetChk or Not
                                                    if (chkInternet == true) {
                                                        //validate Internet Amount
                                                        if (Internet.length > 0) {
                                                            if (chkMobile == true) {
                                                                if (Mobile.length > 0) {
                                                                    FromSaveSubmit();
                                                                }
                                                                else {
                                                                    $(".popupposition").fadeIn();
                                                                    $('#errormessage').text('Please Enter Mobile Bill');
                                                                    $('#errormessage').show();
                                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                                    $('#txtMobileBill').focus();
                                                                    $('input:submit').attr("disabled", false);
                                                                }
                                                            }
                                                            else {
                                                                FromSaveSubmit();
                                                            }
                                                        }
                                                        else {
                                                            $(".popupposition").fadeIn();
                                                            $('#errormessage').text('Please Enter Internet Bill');
                                                            $('#errormessage').show();
                                                            $('.popupposition').delay(3000).fadeOut('slow');
                                                            $('#txtInternetBill').focus();
                                                            $('input:submit').attr("disabled", false);
                                                        }
                                                    }
                                                    else {
                                                        if (chkMobile == true) {
                                                            if (Mobile.length > 0) {
                                                                FromSaveSubmit();
                                                            }
                                                            else {
                                                                $(".popupposition").fadeIn();
                                                                $('#errormessage').text('Please Enter Mobile Bill');
                                                                $('#errormessage').show();
                                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                                $('#txtMobileBill').focus();
                                                                $('input:submit').attr("disabled", false);
                                                            }
                                                        }
                                                        else {
                                                            FromSaveSubmit();
                                                        }
                                                    }
                                                }
                                                else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Please Enter Serial Number for Instrument');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#txtSONoforInstrument').focus();
                                                    $('input:submit').attr("disabled", false);
                                                }
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Please Enter SO No Explanation');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('#txtSOExplanation').focus();
                                                $('input:submit').attr("disabled", false);
                                            }
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Select Client Manager');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#txtClientManagerName").focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter Company Name');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtCompanyName').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Future Dates Not Allowed');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Date');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtDate').focus();
                    $('input:submit').attr("disabled", false);
                }
            }
        }

        function FromSaveSubmit() {
            MobileID = "Mobile Bill";
            InternetID = "Internet Bill";
            //validate expenditure type
            if (ExpenditureType == 'Select') {
                if (Mobile.length > 0 || Internet.length > 0) {
                    if (ExpenditureHeaderID > 0) {
                        InsertExpenditure();
                    }
                    else {
                        $.ajax({
                            url: '/Employee/CheckExpenditure',
                            type: "GET",
                            cache: false,
                            data: { ExpenditureDate: expenditureDate, MobileCheck: MobileSelect, InternetCheck: InternetSelect, FromPage: 'Expense' },
                            success: function (data) {
                                if (data.expenditureDateInLeave == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('input:submit').attr("disabled", false);
                                }
                                else if (data.ExpendituresInBlockedList == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('input:submit').attr("disabled", false);
                                }
                                else if (data.MobileCheckInExpenditure == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Mobile Bill Has Been Submitted For This Month , Please Select Next Month');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('input:submit').attr("disabled", false);
                                }
                                else if (data.InternetCheckInExpenditure == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Internet Bill Has Been Submitted For This Month , Please Select Next Month');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('input:submit').attr("disabled", false);
                                }
                                else if (data.expenditureDateInTraining == 1) {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('input:submit').attr("disabled", false);
                                }
                                else {
                                    Localization = "Local";
                                    CloseExpenditure();
                                }
                            },
                            error: function (event, jqxhr, settings, exception) {
                                alert(exception);
                            }
                        });
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Expenditure Type');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#ddlExpenditureType').focus();
                    $('input:submit').attr("disabled", false);
                }
            }
            //section select expenditure type OTHER
            else if (ExpenditureType == 'Other') {
                //from other selection and reason validate
                if (Reason.length > 0) {
                    //validate Amount
                    if (Amount.length > 0) {
                        if (ExpenditureHeaderID > 0) {
                            InsertExpenditure();
                        }
                        else {
                            $.ajax({
                                url: '/Employee/CheckExpenditure',
                                type: "GET",
                                data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                success: function (data) {
                                    if (data.expenditureDateInLeave == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('input:submit').attr("disabled", false);
                                    }
                                    else if (data.ExpendituresInBlockedList == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('input:submit').attr("disabled", false);
                                    }
                                    else if (data.expenditureDateInTraining == 1) {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('input:submit').attr("disabled", false);
                                    }
                                    else {
                                        Localization = "Local";
                                        CloseExpenditure();
                                    }
                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter Amount');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtAmount').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Enter Expense Details');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $("#txtReason").focus();
                    $('input:submit').attr("disabled", false);
                }
            }
            else {
                //validate from location when select car and bike
                if (FromLocation.length > 0) {
                    //validate to location when select car and bike
                    if (ToLocation.length > 0) {
                        //validate kms when select car and bike
                        if (Kms.length > 0) {
                            if (Conveyance.length > 0) {
                                if (ExpenditureHeaderID > 0) {
                                    InsertExpenditure();
                                }
                                else {
                                    $.ajax({
                                        url: '/Employee/CheckExpenditure',
                                        type: "GET",
                                        data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                        success: function (data) {
                                            if (data.expenditureDateInLeave == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else if (data.ExpendituresInBlockedList == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else if (data.expenditureDateInTraining == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else {
                                                Localization = "Local";
                                                CloseExpenditure();
                                            }
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                }
                            }
                            else {
                                //validate amount when select car and bike
                                if (Amount.length > 0) {
                                    if (ExpenditureHeaderID > 0) {
                                        InsertExpenditure();
                                    }
                                    else {
                                        $.ajax({
                                            url: '/Employee/CheckExpenditure',
                                            type: "GET",
                                            data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                                            success: function (data) {
                                                if (data.expenditureDateInLeave == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('input:submit').attr("disabled", false);
                                                }
                                                else if (data.ExpendituresInBlockedList == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('input:submit').attr("disabled", false);
                                                }
                                                else if (data.expenditureDateInTraining == 1) {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('input:submit').attr("disabled", false);
                                                }
                                                else {
                                                    Localization = "Local";
                                                    CloseExpenditure();
                                                }
                                            },
                                            error: function (event, jqxhr, settings, exception) {
                                                alert(exception);
                                            }
                                        });
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter Amount');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtAmount').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter Kms');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtKms').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter To Location');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtToLocation').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Enter From Location');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtFrom').focus();
                    $('input:submit').attr("disabled", false);
                }
            }
        }

        function CloseExpenditure() {
            $.ajax({
                url: '/Employee/CheckExpenditure',
                type: "GET",
                cache: false,
                data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                success: function (data) {
                    if (data.expenditureDateInLeave == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else if (data.ExpendituresInBlockedList == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else if (data.expenditureDateInTraining == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else {
                        if (multipleCheck == true) {
                            Localization = "Local";
                            $.ajax({
                                url: '/Employee/MultipleServiceOrders',
                                type: "POST",
                                dataType: 'json',
                                data: { FormData: JSON.stringify(MultipleArrayValues), ExpenseDate: expenditureDate, ClientName: ClientName,
                                    From: FromLocation, To: ToLocation, ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                                    ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance, Localization: Localization,
                                    ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments
                                },
                                success: function (data) {
                                    $('#txtHeaderID').val(data);
                                    ExpenditureHeaderID = data;
                                    //closing
                                    $.ajax({
                                        url: '/Employee/ExpenditureListClose',
                                        type: "POST",
                                        cache: false,
                                        data: { HeaderID: data, FromStatus: FromStatus },
                                        success: function (data) {

                                            if (FromStatus == true) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Submitted Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            else if (FromStatus == false) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Saved Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }

                                            ClearLocalFields();
                                            $('#txtHeaderID').val('');
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });

                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                        else {
                            Localization = "Local";
                            $.ajax({
                                url: '/Employee/LocalExpenditure',
                                type: "POST",
                                data: { ExpenseDate: expenditureDate, ClientName: ClientName, ServiceOrderNumber: SONo,
                                    OrderConfirmationNo: OrderConfirmationNo,
                                    From: FromLocation, To: ToLocation,
                                    ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                                    SOExplanation: SOExplanation, ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance,
                                    Localization: Localization, ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments, Mobile: Mobile, MobileTypeID: MobileID, Internet: Internet, InternetID: InternetID, SerialNoInstrument: SONoInstruments, OrderConfirmationDate: OrderConfirmationDate, MobileNo: MobileNo, MobileComment: MobileComment, InternetNo: InternetNo, InternetComment: InternetComment
                                },
                                dataType: 'json',
                                success: function (data) {
                                    $('#txtHeaderID').val(data);
                                    ExpenditureHeaderID = data;
                                    //closing
                                    $.ajax({
                                        url: '/Employee/ExpenditureListClose',
                                        type: "POST",
                                        cache: false,
                                        data: { HeaderID: data, FromStatus: FromStatus },
                                        success: function (data) {
                                            if (FromStatus == true) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Submitted Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            else if (FromStatus == false) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Saved Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            ClearLocalFields();
                                            $('#txtHeaderID').val('');
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                    }
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }

        $("#btnSubmit").click(function (e) {
            e.preventDefault();
            $('input:submit').attr("disabled", true);
            ExpenditureHeaderID = $('#txtHeaderID').val();
            if (ExpenditureHeaderID > 0) {
                SONo = $('#txtSONo').val();
                OrderConfirmationNo = $('#SOConfirmationNo').val();
                OrderConfirmationDate = $('#txtOCDate').val();
                SOExplanation = $('#txtSOExplanation').val();
                SONoInstruments = $('#txtSONoforInstrument').val();
                $.ajax({
                    url: '/Employee/ExpenditureListClose',
                    type: "POST",
                    cache: false,
                    data: { HeaderID: ExpenditureHeaderID, SONo: SONo, OrderConfirmationNo: OrderConfirmationNo, OrderConfirmationDate: OrderConfirmationDate, SOExplanation: SOExplanation, FromStatus: 'true', SerialNoInstrument: SONoInstruments },
                    success: function (data) {
                        $(".popuppositionsucess").fadeIn();
                        $('#sucessresult').text('Your Expenditure Submitted Successfully');
                        $('#sucessresult').show();
                        $('.popuppositionsucess').delay(3000).fadeOut('slow');
                        ClearLocalFields();
                        $('#txtHeaderID').val('');
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
            else {

                FromStatus = true;
                SingleSubmission();
            }
        });

        //hide/show so# and so explanation based on status of SO NO  in Outstation part
        $('#ddlOutSONoStatus').change(function (e) {
            e.preventDefault();
            var statusID = $('#ddlOutSONoStatus').val();
            if (statusID == 2) {
                $("#divOutSOExplanation").show();
                $('#divOutSOInstrument').show();
                $("#divOutSONo").hide();
                $('#divOutSOCNo').hide();
                $('#divOutSOCNoDate').hide();
                $('#instrumentTotal').show();
                $('#txtOutSONo').val('');
                $('#OutSOConfirmationNo').val('');
                $('#txtOutOCDate').val('');
                $('#txtOutOCDate').datepicker('setDate', new Date());
                $('#txtOutSOExplanation').val('');
                $('#txtOutSONoforInstrument').val('');
            }
            else {
                $("#divOutSOExplanation").hide();
                $('#divOutSOInstrument').hide();
                $("#divOutSONo").show();
                $('#divOutSOCNo').show();
                $('#divOutSOCNoDate').show();
                $('#instrumentTotal').hide();
                $('#txtOutSONo').val('');
                $('#OutSOConfirmationNo').val('');
                $('#txtOutOCDate').val('');
                $('#txtOutOCDate').datepicker('setDate', new Date());
                $('#txtOutSOExplanation').val('');
                $('#txtOutSONoforInstrument').val('');
            }
        });

        //bind expenditure type detail based on selections of expenditure type
        $('#ddlOutExpenditureType').change(function (e) {
            e.preventDefault();
            var ExpenditureId = $('#ddlOutExpenditureType').val();
            $('#divOutFrom').show();
            $('#divOutTo').show();
            $('#txtOutReason').val('');
            $('#divOutReason').hide();
            if (ExpenditureId > 0) {
                $.ajax({
                    url: '/Employee/ExpenditureTypeDetailsByID',
                    type: "GET",
                    cache: false,
                    data: { ExpenseTypeHeaderID: ExpenditureId },
                    success: function (expenseTypeDetails) {
                        $("#ddlOutExpenditureTypeDetail").html("");
                        $('#ddlOutExpenditureTypeDetail').append('<option value="0">Select Expenditure Type Details</option');
                        $.each(expenseTypeDetails, function (i, expensetypedetail) {
                            $("#ddlOutExpenditureTypeDetail").append('<option value="' + expensetypedetail.ID + '">' + expensetypedetail.Description + '</option>');
                        });
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(jqxhr);
                    }
                });
            }
            else {
                $("#ddlOutExpenditureTypeDetail").html("");
                $('#ddlOutExpenditureTypeDetail').append('<option value="0">Select Expenditure Type Details</option');
            }
        });

        //checking the expenditure is already exist or not in Leave and Expenditure
        $('#txtOutstationDate').on('changeDate', function (e) {
            e.preventDefault();
            var selectedDate = this.value;
            var TodayDate = new Date();
            if (Date.parse(e.date) <= Date.parse(TodayDate)) {
                //verifying condition
                $.ajax({
                    url: '/Employee/CheckExpenditure',
                    type: "GET",
                    cache: false,
                    data: { ExpenditureDate: this.value, FromPage: 'Expense' },
                    success: function (data) {
                        if (data.expenditureDateInLeave == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                        }
                        else if (data.ExpendituresInBlockedList == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                        }
                        else if (data.expenditureDateInTraining == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                        }
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
            else {
                $(".popupposition").fadeIn();
                $('#errormessage').text('Future Dates Not Allowed');
                $('#errormessage').show();
                $('.popupposition').delay(3000).fadeOut('slow');
                $('#txtOutstationDate').datepicker("setDate", new Date());
                $('#txtOutstationDate').datepicker("update");
            }
            $(this).datepicker('hide');
        });

        //clear the outstation controls
        function ClearOutStationFields() {
            $('#txtOutstationDate').attr('disabled', false);
            $('#txtOutClientName').attr('disabled', false);
            $('#txtOutClientManagerName').attr('disabled', false);
            $('#ddlOutSONoStatus').attr('disabled', false);
            $('#txtOutSONo').attr('disabled', false);
            $('#txtOutSOExplanation').attr('disabled', false);

            $('#yearpicker').attr('disabled', false);
            $('#month').attr('disabled', false);
            $('#days').attr('disabled', false);

            $('#txtOutstationDate').val('');
            //            $('#txtOutstationDate').datepicker();

            //$("#txtOutstationDate").datepicker("remove");

            $('#txtOutClientName').val('');
            $('#txtOutClientManagerName').val('');
            $('#ddlOutSONoStatus').val(0);
            $('#txtOutSONo').val('');
            $('#txtOutSOExplanation').val('');
            $('#OutSOConfirmationNo').val('');
            $('#txtOutFrom').val('');
            $('#txtOutToLocation').val('');
            $('#ddlOutExpenditureType option:eq(0)').attr('selected', 'selected');
            $('#ddlOutExpenditureTypeDetail').empty();
            $('#ddlOutExpenditureTypeDetail').append('<option value="0">Select Expenditure Type Details</option');
            $('#txtOutAmount').val('');
            $("#expenselist").html('');
            $('#txtOutReason').val('');
            $('#divOutReason').hide();
            $('#txtComments').val('');
            $('#divOutFrom').show();
            $('#divOutTo').show();
            $("#chkOutMobile").attr('checked', false);
            $('#txtOutMobileBill').val('');
            $('#txtOutInternetBill').val('');
            $("#chkOutInternet").attr('checked', false);
            $('#divOutMobile').hide();
            $('#divOutInternet').hide();
            $('#divOutSOInstrument').hide();
            $('#txtOutSONoforInstrument').val('');
            $('#txtOutOCDate').val('');
            $('#txtOutOCDate').datepicker("setDate", new Date());
            $('#txtOutOCDate').datepicker("update");
            $('#divOutInternetNo').hide();
            $('#txtOutInternetNo').val('');
            $('#divOutInternetComment').hide();
            $('#txtOutInternetComment').val('');
            $('#divOutMobileNo').hide();
            $('#txtOutMobileNo').val('');
            $('#divOutMobileComment').hide();
            $('#txtOutMobileComment').val('');
            $('#divOutClientSection').show();
            $('#divOutExpenseSection').show();
            $('#divOutSONo').show();
            $('#divOutSOCNo').show();
            $('#divOutSOCNoDate').show();
            $('#instrumentTotal').hide();
            $('#divOutSOExplanation').hide();
            $('#divOutExpenditureTypes').show();
            $("#divSONos").html('');
            multipleCheck = $('#chkOutMultiple').is(":checked");
            if (multipleCheck == true) {
                $('#TextBoxContainerForOut').find('div').each(function () {
                    $(this).remove();
                    MultipleArrayValues = [];
                    counter--;
                });
            }
            $('#chkOutMultiple').attr('checked', false);
            $('#btnOutAddSONOs').hide();
            $('#chkOutMultiple').attr('disabled', false);
            counter = 1;
            $('input:submit').attr("disabled", false);
        }

        $("#btnOutReset").click(function (e) {
            e.preventDefault();
            ClearOutStationFields();
            $('#txtOutstationDate').datepicker('setDate', new Date());


            $('#txtOutstationDate').datepicker("update");
            //            $("#txtOutstationDate").datepicker("remove");
        });

        $('#ddlOutExpenditureTypeDetail').change(function (e) {
            e.preventDefault();
            var statusID = $('#ddlOutExpenditureTypeDetail option:selected').text();
            if (statusID == "Other" || statusID == "Lodging" || statusID == "Parking/Toll" || statusID == "Breakfast" || statusID == "Lunch" || statusID == "Dinner") {
                $('#divOutFrom').hide();
                $('#divOutTo').hide();
                $('#divOutReason').show();
            }
            else {
                $('#txtOutReason').val('');
                $('#divOutReason').hide();
                $('#divOutFrom').show();
                $('#divOutTo').show();
            }
        });

        //button Add functionality
        $("#btnOutAdd").click(function (e) {
            e.preventDefault();
            $("#btnOutAdd").attr('disabled', true);
            $('#yearpicker').attr('disabled', true);
            $('#month').attr('disabled', true);
            $('#days').attr('disabled', true);
            expenditureDate = $('#txtOutstationDate').val();
            ClientName = $('#txtOutClientName').val();
            ClientManagerName = $('#txtOutClientManagerName  option:selected').text();
            ClientManagerStatus = $('#txtOutClientManagerName').val();
            SOServiceStatus = $('#ddlOutSONoStatus').val();
            var date = new Date();
            SOExplanation = $('#txtOutSOExplanation').val();
            SONoInstruments = $('#txtOutSONoforInstrument').val();
            OrderConfirmationDate = $('#txtOutOCDate').val();
            OrderConfirmationNo = $('#OutSOConfirmationNo').val();
            comments = $('#txtComments').val();
            var ddlmultiCount;
            var eachCount;
            multipleCheck = $('#chkOutMultiple').is(":checked");
            if (multipleCheck == true) {
                ddlmultiCount = $(".ddlMultiStatus").length;
                eachCount = 0;
                $(".ddlMultiStatus").each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                $("#btnOutAdd").attr('disabled', false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            $("#btnOutAdd").attr('disabled', false);
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {
                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', MultiSOCD)) {
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                                $("#btnOutAdd").attr('disabled', false);
                                                return false;
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            $("#btnOutAdd").attr('disabled', false);
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        $("#btnOutAdd").attr('disabled', false);
                                        return false;
                                    }
                                }
                                else {
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                $("#btnOutAdd").attr('disabled', false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            $("#btnOutAdd").attr('disabled', false);
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        this.focus();
                        $("#btnOutAdd").attr('disabled', false);
                        return false;
                    }
                    eachCount++;
                });
                MultipleArrayValues = [];
                if (eachCount == ddlmultiCount) {
                    if (expenditureDate.length > 0) {
                        //date condition check if today or below today to allow expenditure submittion else select valid date
                        if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                            //validate client Name
                            if (ClientName.length > 0) {
                                //validate client Manager Name
                                if (ClientManagerStatus > 0) {
                                    var SCONOS = 1;
                                    $('.Multiple').each(function () {
                                        var values = [];
                                        var List = 1;
                                        $(this).find('input[type=text]').each(function (e) {
                                            var item = {
                                                "Id": this.name + SCONOS,
                                                "Value": $(this).val()
                                            };
                                            values.push(item)
                                            List++;
                                        });

                                        MultipleArrayValues.push(values);
                                        SCONOS++;
                                    });

                                    if (MultipleArrayValues.length > 0) {
                                        FromOutExpenditureAdd();
                                        $('#chkOutMultiple').attr('disabled', true);
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Add Multiple Service Order Nos and Fill Appropriate Details');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnOutAddSONOs").focus();
                                        $("#btnOutAdd").attr('disabled', false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Select Client Manager');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#txtClientManagerName").focus();
                                    $("#btnOutAdd").attr('disabled', false);
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Company Name');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtCompanyName').focus();
                                $("#btnOutAdd").attr('disabled', false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Future Dates Not Allowed');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtDate').focus();
                            $("#btnOutAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $("#btnOutAdd").attr('disabled', false);
                    }
                }
            }
            else {
                //checking date condition
                if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                    if (ClientName.length > 0) {
                        if (ClientManagerStatus > 0) {
                            //checking the status of Service order
                            if (SOServiceStatus == 0) {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Select Service Order Status');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#ddlOutSONoStatus').focus();
                                $("#btnOutAdd").attr('disabled', false);
                            }
                            else if (SOServiceStatus == 1) {
                                SONo = $('#txtOutSONo').val();
                                //checking the value of SO No to allow or not
                                if (SONo.length > 0) {
                                    if (SONo.length >= 10 && SONo.length <= 15) {
                                        if (OrderConfirmationNo.length > 0) {
                                            if (OrderConfirmationNo.length >= 10 && OrderConfirmationNo.length <= 15) {
                                                if (OrderConfirmationDate.length > 0) {
                                                    if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', OrderConfirmationDate)) {
                                                        FromOutExpenditureAdd();
                                                    }
                                                    else {
                                                        $(".popupposition").fadeIn();
                                                        $('#errormessage').text('SO confirmation date should be greate-than expenditure date');
                                                        $('#errormessage').show();
                                                        $('.popupposition').delay(3000).fadeOut('slow');
                                                        $('#txtOutOCDate').focus();
                                                        $("#btnOutAdd").attr('disabled', false);
                                                    }
                                                } else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Please Select SO Confirmation Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#txtOutOCDate').focus();
                                                    $("#btnOutAdd").attr('disabled', false);
                                                }
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('#OutSOConfirmationNo').focus();
                                                $("#btnOutAdd").attr('disabled', false);
                                            }
                                        }
                                        else {
                                            FromOutExpenditureAdd();
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtOutSONo').focus();
                                        $("#btnOutAdd").attr('disabled', false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter SO No');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtOutSONo').focus();
                                    $("#btnOutAdd").attr('disabled', false);
                                }
                            }
                            else if (SOServiceStatus == 2) {
                                SOExplanation = $('#txtOutSOExplanation').val();
                                //checking the value of SO Explanation to allow or not
                                if (SOExplanation.length > 0) {
                                    if (SONoInstruments.length > 0) {
                                        FromOutExpenditureAdd();
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Enter Serial Number for Instrument');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtOutSONoforInstrument').focus();
                                        $("#btnOutAdd").attr('disabled', false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter SO Explanation');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtOutSOExplanation').focus();
                                    $("#btnOutAdd").attr('disabled', false);
                                }
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Select Client Manager');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutClientManagerName').focus();
                            $("#btnOutAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter Client Name');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtOutClientName').focus();
                        $("#btnOutAdd").attr('disabled', false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Future Dates Not Allowed');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtOutstationDate').datepicker("setDate", new Date());
                    $("#btnOutAdd").attr('disabled', false);
                }
            }
        });

        //check expense is exist or not in Leave and Expenditure table
        function OutCheckExpenditure() {
            ExpenditureHeaderID = $('#txtHeaderID').val();
            if (ExpenditureHeaderID > 0) {
                Localization = "Outstation";
                InsertExpenditure();
            }
            else {
                $.ajax({
                    url: '/Employee/CheckExpenditure',
                    type: "GET",
                    data: { ExpenditureDate: $("#txtOutstationDate").val(), FromPage: 'Expense' },
                    success: function (data) {
                        if (data.expenditureDateInLeave == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $("#btnOutAdd").attr('disabled', false);
                        }
                        else if (data.ExpendituresInBlockedList == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $("#btnOutAdd").attr('disabled', false);
                        }
                        else if (data.expenditureDateInTraining == 1) {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $("#btnOutAdd").attr('disabled', false);
                        }
                        else {
                            Localization = "Outstation";
                            InsertExpenditure();
                        }
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
        }

        function FromOutExpenditureAdd() {

            FromLocation = $('#txtOutFrom').val();
            ToLocation = $('#txtOutToLocation').val();
            ExpenditureType = $('#ddlOutExpenditureTypeDetail option:selected').text();
            var expenseType = $('#ddlOutExpenditureType option:selected').text();
            Amount = $('#txtOutAmount').val();
            Conveyance = "";
            Kms = "";
            Reason = $('#txtOutReason').val();
            if (expenseType == 'Select Expenditure Type') {
                $(".popupposition").fadeIn();
                $('#errormessage').text('Please Select Expenditure Type');
                $('#errormessage').show();
                $('.popupposition').delay(3000).fadeOut('slow');
                $('#ddlOutExpenditureType').focus();
                $("#btnOutAdd").attr('disabled', false);
            }
            else {
                if (ExpenditureType == 'Select Expenditure Type Details') {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Expenditure Type Details');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#ddlOutExpenditureTypeDetail').focus();
                    $("#btnOutAdd").attr('disabled', false);
                }
                else if (ExpenditureType == 'Other' || ExpenditureType == "Lodging" || ExpenditureType == "Parking/Toll" || ExpenditureType == "Breakfast" || ExpenditureType == "Lunch" || ExpenditureType == "Dinner") {
                    if (Reason.length > 0) {
                        if (Amount.length > 0) {
                            OutCheckExpenditure()
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter Amount');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutAmount').focus();
                            $("#btnOutAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter Expense Details');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtOutReason').focus();
                        $("#btnOutAdd").attr('disabled', false);
                        return;
                    }
                }
                else {
                    if (FromLocation.length > 0) {
                        if (ToLocation.length > 0) {
                            if (Amount.length > 0) {
                                OutCheckExpenditure()
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Amount');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtOutAmount').focus();
                                $("#btnOutAdd").attr('disabled', false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter To Location');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutToLocation').focus();
                            $("#btnOutAdd").attr('disabled', false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter From Location');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtOutFrom').focus();
                        $("#btnOutAdd").attr('disabled', false);
                    }
                }
            }
        }

        //button save functionality
        $("#btnOutSave").click(function (e) {
            e.preventDefault();
            $('input:submit').attr("disabled", true);
            ExpenditureHeaderID = $('#txtHeaderID').val();
            SONo = $('#txtOutSONo').val();
            OrderConfirmationNo = $('#OutSOConfirmationNo').val();
            OrderConfirmationDate = $('#txtOutOCDate').val();
            SOExplanation = $('#txtOutSOExplanation').val();
            SONoInstruments = $('#txtOutSONoforInstrument').val();
            comments = $('#txtComments').val();
            if (ExpenditureHeaderID > 0) {
                $.ajax({
                    url: '/Employee/ExpenditureListClose',
                    type: "POST",
                    cache: false,
                    data: { HeaderID: ExpenditureHeaderID, SONo: SONo, OrderConfirmationNo: OrderConfirmationNo, OrderConfirmationDate: OrderConfirmationDate, SOExplanation: SOExplanation, FromStatus: 'false', Comments: comments, SerialNoInstrument: SONoInstruments },
                    success: function (data) {
                        $(".popuppositionsucess").fadeIn();
                        $('#sucessresult').text('Your Expenditure Saved Successfully');
                        $('#sucessresult').show();
                        $('.popuppositionsucess').delay(3000).fadeOut('slow');
                        $("#expenselist").html('');
                        $('#no').prop("checked", true);
                        $('#yes').prop("checked", false);
                        ClearOutStationFields();
                        $('#txtComments').val('');
                        $('#txtHeaderID').val('');
                        $('#txtOutstationDate').datepicker("update");
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
            else {
                FromStatus = false;
                SingleOutSubmission();
            }
        });

        $("#btnOutSubmit").click(function (e) {
            e.preventDefault();
            $('input:submit').attr("disabled", true);
            ExpenditureHeaderID = $('#txtHeaderID').val();
            SONo = $('#txtOutSONo').val();
            OrderConfirmationNo = $('#OutSOConfirmationNo').val();
            OrderConfirmationDate = $('#txtOutOCDate').val();
            SOExplanation = $('#txtOutSOExplanation').val();
            SONoInstruments = $('#txtOutSONoforInstrument').val();
            comments = $('#txtComments').val();
            if (ExpenditureHeaderID > 0) {
                $.ajax({
                    url: '/Employee/ExpenditureListClose',
                    type: "POST",
                    cache: false,
                    data: { HeaderID: ExpenditureHeaderID, SONo: SONo, OrderConfirmationNo: OrderConfirmationNo, OrderConfirmationDate: OrderConfirmationDate, SOExplanation: SOExplanation, FromStatus: 'true', Comments: comments, SerialNoInstrument: SONoInstruments },
                    success: function (data) {
                        $(".popuppositionsucess").fadeIn();
                        $('#sucessresult').text('Your Expenditure Submitted Successfully');
                        $('#sucessresult').show();
                        $('.popuppositionsucess').delay(3000).fadeOut('slow');
                        $("#expenselist").html('');
                        $('#no').prop("checked", true);
                        $('#yes').prop("checked", false);
                        ClearOutStationFields();
                        $('#txtComments').val('');
                        $('#txtHeaderID').val('');
                        $('#txtOutstationDate').datepicker("update");
                    },
                    error: function (event, jqxhr, settings, exception) {
                        alert(exception);
                    }
                });
            }
            else {
                FromStatus = true;
                SingleOutSubmission();
            }
        });


        function SingleOutSubmission() {
            MultipleArrayValues = [];
            expenditureDate = $('#txtOutstationDate').val();
            ClientName = $('#txtOutClientName').val();
            ClientManagerName = $('#txtOutClientManagerName option:selected').text();
            ClientManagerStatus = $('#txtOutClientManagerName').val();
            SOServiceStatus = $('#ddlOutSONoStatus').val();
            var date = new Date();
            SOExplanation = $('#txtOutSOExplanation').val();
            SONoInstruments = $('#txtOutSONoforInstrument').val();
            OrderConfirmationDate = $('#txtOutOCDate').val();
            OrderConfirmationNo = $('#OutSOConfirmationNo').val();
            So = $('txtOutSONo').val();
            var ddlmultiCount;
            var eachCount;
            multipleCheck = $('#chkOutMultiple').is(":checked");
            if (multipleCheck == true) {
                ddlmultiCount = $(".ddlMultiStatus").length;
                eachCount = 0;
                $(".ddlMultiStatus").each(function () {
                    var status = this.value;
                    if (status == 2) {
                        var MultiExpplanation = $(this).closest('.Multiple').find('input[name=txtSOExplanation]').val();
                        var MultiInstument = $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').val();
                        if (MultiExpplanation.length > 0) {
                            if (MultiInstument.length > 0) {
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Serial Number for instruments');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONoforInstrument]').focus();
                                $('input:submit').attr("disabled", false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO Explanation');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSOExplanation]').focus();
                            $('input:submit').attr("disabled", false);
                            return false;
                        }
                    }
                    else if (status == 1) {
                        var MultiSONo = $(this).closest('.Multiple').find('input[name=txtSONo]').val();
                        var MultiSOCN = $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').val();
                        var MultiSOCD = $(this).closest('.Multiple').find('input[name=txtOCDate]').val();
                        if (MultiSONo.length > 0) {
                            if (MultiSONo.length >= 10 && MultiSONo.length <= 15) {
                                if (MultiSOCN.length > 0) {
                                    if (MultiSOCN.length >= 10 && MultiSOCN.length <= 15) {
                                        if (MultiSOCD.length > 0) {
                                            if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', MultiSOCD)) {
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO confirmation date should be greate-than expenditure date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                                $('input:submit').attr("disabled", false);
                                                return false;
                                            }
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Select SO Confirmation Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $(this).closest('.Multiple').find('input[name=txtOCDate]').focus();
                                            $('input:submit').attr("disabled", false);
                                            return false;
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $(this).closest('.Multiple').find('input[name=SOConfirmationNo]').focus();
                                        $('input:submit').attr("disabled", false);
                                        return false;
                                    }
                                }
                                else {
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                                $('input:submit').attr("disabled", false);
                                return false;
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter SO No');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $(this).closest('.Multiple').find('input[name=txtSONo]').focus();
                            $('input:submit').attr("disabled", false);
                            return false;
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Service Order No Status');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                        this.focus();
                        return false;
                    }
                    eachCount++;
                });

                if (eachCount == ddlmultiCount) {
                    if (expenditureDate.length > 0) {
                        //date condition check if today or below today to allow expenditure submittion else select valid date
                        if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                            //validate client Name
                            if (ClientName.length > 0) {
                                //validate client Manager Name
                                if (ClientManagerStatus > 0) {
                                    var SCONOS = 1;
                                    $('.Multiple').each(function () {
                                        var values = [];
                                        var List = 1;
                                        $(this).find('input[type=text]').each(function (e) {
                                            var item = {
                                                "Id": this.name + SCONOS,
                                                "Value": $(this).val()
                                            };
                                            values.push(item)
                                            List++;
                                        });

                                        MultipleArrayValues.push(values);
                                        SCONOS++;
                                    });

                                    if (MultipleArrayValues.length > 0) {
                                        if (eachCount > 1) {
                                            FromSaveExpenditureAdd();
                                        }
                                        else {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Please Add At-least two Multiple Service Order Nos/Uncheck Multiple CheckBox');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $("#btnOutAddSONOs").focus();
                                            $('input:submit').attr("disabled", false);
                                        }

                                        //$('#chkOutMultiple').attr('disabled', true);
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Add Multiple Service Order Nos and Fill Appropriate Details');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $("#btnOutAddSONOs").focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Select Client Manager');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $("#txtClientManagerName").focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Company Name');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtCompanyName').focus();
                                $('input:submit').attr("disabled", false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Future Dates Not Allowed');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtDate').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtDate').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
            }
            else {
                if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= Date.parse(date)) {
                    if (ClientName.length > 0) {
                        if (ClientManagerStatus > 0) {
                            if (SOServiceStatus == 0) {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Select Service Order Status');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#ddlOutSONoStatus').focus();
                                $('input:submit').attr("disabled", false);
                            }
                            else if (SOServiceStatus == 1) {
                                SONo = $('#txtOutSONo').val();
                                if (SONo.length > 0) {
                                    if (SONo.length >= 10 && SONo.length <= 15) {
                                        if (OrderConfirmationNo.length > 0) {
                                            if (OrderConfirmationNo.length >= 10 && OrderConfirmationNo.length <= 15) {
                                                if (OrderConfirmationDate.length > 0) {
                                                    if ($.datepicker.parseDate("dd/mm/yy", expenditureDate) <= $.datepicker.parseDate('dd/mm/yy', OrderConfirmationDate)) {
                                                        FromSaveExpenditureAdd();
                                                    }
                                                    else {
                                                        $(".popupposition").fadeIn();
                                                        $('#errormessage').text('SO confirmation date should be greater-than expenditure date');
                                                        $('#errormessage').show();
                                                        $('.popupposition').delay(3000).fadeOut('slow');
                                                        $('#txtOutOCDate').focus();
                                                        $('input:submit').attr("disabled", false);
                                                    }
                                                }
                                                else {
                                                    $(".popupposition").fadeIn();
                                                    $('#errormessage').text('Please Select SO Confirmation Date');
                                                    $('#errormessage').show();
                                                    $('.popupposition').delay(3000).fadeOut('slow');
                                                    $('#txtOutOCDate').focus();
                                                    $('input:submit').attr("disabled", false);
                                                }
                                            }
                                            else {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('SO Confirmation No Must Be Minimum 10 Digits');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('#OutSOConfirmationNo').focus();
                                                $('input:submit').attr("disabled", false);
                                            }
                                        }
                                        else {
                                            FromSaveExpenditureAdd();
                                        }
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('SO No Must Be Minimum 10 Digits');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtOutSONo').focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter SO No');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtOutSONo').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                            else if (SOServiceStatus == 2) {
                                SOExplanation = $('#txtOutSOExplanation').val();
                                //checking the value of SO Explanation to allow or not
                                if (SOExplanation.length > 0) {
                                    if (SONoInstruments.length > 0) {
                                        FromSaveExpenditureAdd();
                                    }
                                    else {
                                        $(".popupposition").fadeIn();
                                        $('#errormessage').text('Please Enter Serial Number for Instrument');
                                        $('#errormessage').show();
                                        $('.popupposition').delay(3000).fadeOut('slow');
                                        $('#txtOutSONoforInstrument').focus();
                                        $('input:submit').attr("disabled", false);
                                    }
                                }
                                else {
                                    $(".popupposition").fadeIn();
                                    $('#errormessage').text('Please Enter SO Explanation');
                                    $('#errormessage').show();
                                    $('.popupposition').delay(3000).fadeOut('slow');
                                    $('#txtOutSOExplanation').focus();
                                    $('input:submit').attr("disabled", false);
                                }
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Select Client Manager');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutClientManagerName').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter Client Name');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtOutClientName').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
                else {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Future Dates Not Allowed');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#txtOutstationDate').datepicker("setDate", new Date());
                    $('input:submit').attr("disabled", false);
                }
            }
        }

        function FromSaveExpenditureAdd() {
            FromLocation = $('#txtOutFrom').val();
            ToLocation = $('#txtOutToLocation').val();
            ExpenditureType = $('#ddlOutExpenditureTypeDetail option:selected').text();
            var expenseType = $('#ddlOutExpenditureType option:selected').text();
            Amount = $('#txtOutAmount').val();
            Conveyance = "";
            Kms = "";
            Reason = $('#txtOutReason').val();
            if (expenseType == 'Select Expenditure Type') {
                $(".popupposition").fadeIn();
                $('#errormessage').text('Please Select Expenditure Type');
                $('#errormessage').show();
                $('.popupposition').delay(3000).fadeOut('slow');
                $('#ddlOutExpenditureType').focus();
                $('input:submit').attr("disabled", false);
            }
            else {
                if (ExpenditureType == 'Select Expenditure Type Details') {
                    $(".popupposition").fadeIn();
                    $('#errormessage').text('Please Select Expenditure Type Details');
                    $('#errormessage').show();
                    $('.popupposition').delay(3000).fadeOut('slow');
                    $('#ddlOutExpenditureTypeDetail').focus();
                    $('input:submit').attr("disabled", false);
                }
                else if (ExpenditureType == 'Other' || ExpenditureType == "Lodging" || ExpenditureType == "Parking/Toll" || ExpenditureType == "Breakfast" || ExpenditureType == "Lunch" || ExpenditureType == "Dinner") {
                    if (Reason.length > 0) {
                        if (Amount.length > 0) {
                            ExpenditureHeaderID = $('#txtHeaderID').val();
                            if (ExpenditureHeaderID > 0) {
                                Localization = "Outstation";
                                InsertExpenditure();
                            }
                            else {
                                $.ajax({
                                    url: '/Employee/CheckExpenditure',
                                    type: "GET",
                                    data: { ExpenditureDate: $("#txtOutstationDate").val(), FromPage: 'Expense' },
                                    success: function (data) {
                                        if (data.expenditureDateInLeave == 1) {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('input:submit').attr("disabled", false);
                                        }
                                        else if (data.ExpendituresInBlockedList == 1) {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('input:submit').attr("disabled", false);
                                        }
                                        else if (data.expenditureDateInTraining == 1) {
                                            $(".popupposition").fadeIn();
                                            $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                            $('#errormessage').show();
                                            $('.popupposition').delay(3000).fadeOut('slow');
                                            $('input:submit').attr("disabled", false);
                                        }
                                        else {
                                            Localization = "Outstation";
                                            CloseExpenditureForOutSaveSubmit();
                                        }
                                    },
                                    error: function (event, jqxhr, settings, exception) {
                                        alert(exception);
                                    }
                                });
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter Amount');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutAmount').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Select Expenditure Type Details');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        alert('Please Enter Expense Details');
                        $('#txtOutReason').focus();
                        $('input:submit').attr("disabled", false);
                        return;
                    }
                }
                else {
                    if (FromLocation.length > 0) {
                        if (ToLocation.length > 0) {
                            if (Amount.length > 0) {
                                ExpenditureHeaderID = $('#txtHeaderID').val();
                                if (ExpenditureHeaderID > 0) {
                                    Localization = "Outstation";
                                    InsertExpenditure();
                                }
                                else {
                                    $.ajax({
                                        url: '/Employee/CheckExpenditure',
                                        type: "GET",
                                        cache: false,
                                        data: { ExpenditureDate: $("#txtOutstationDate").val(), FromPage: 'Expense' },
                                        success: function (data) {
                                            if (data.expenditureDateInLeave == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else if (data.ExpendituresInBlockedList == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else if (data.expenditureDateInTraining == 1) {
                                                $(".popupposition").fadeIn();
                                                $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                                                $('#errormessage').show();
                                                $('.popupposition').delay(3000).fadeOut('slow');
                                                $('input:submit').attr("disabled", false);
                                            }
                                            else {
                                                Localization = "Outstation";
                                                CloseExpenditureForOutSaveSubmit();
                                            }
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                }
                            }
                            else {
                                $(".popupposition").fadeIn();
                                $('#errormessage').text('Please Enter Amount');
                                $('#errormessage').show();
                                $('.popupposition').delay(3000).fadeOut('slow');
                                $('#txtOutAmount').focus();
                                $('input:submit').attr("disabled", false);
                            }
                        }
                        else {
                            $(".popupposition").fadeIn();
                            $('#errormessage').text('Please Enter To Location');
                            $('#errormessage').show();
                            $('.popupposition').delay(3000).fadeOut('slow');
                            $('#txtOutToLocation').focus();
                            $('input:submit').attr("disabled", false);
                        }
                    }
                    else {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Please Enter From Location');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('#txtOutFrom').focus();
                        $('input:submit').attr("disabled", false);
                    }
                }
            }
        }

        function CloseExpenditureForOutSaveSubmit() {
            $.ajax({
                url: '/Employee/CheckExpenditure',
                type: "GET",
                cache: false,
                data: { ExpenditureDate: expenditureDate, FromPage: 'Expense' },
                success: function (data) {
                    if (data.expenditureDateInLeave == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('You Have Already Applied for Leave, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else if (data.ExpendituresInBlockedList == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Blocked By Account Manager, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else if (data.expenditureDateInTraining == 1) {
                        $(".popupposition").fadeIn();
                        $('#errormessage').text('Selected Date Has Been Assigned Training Date, Please Select New Date');
                        $('#errormessage').show();
                        $('.popupposition').delay(3000).fadeOut('slow');
                        $('input:submit').attr("disabled", false);
                    }
                    else {
                        Localization = "Outstation";
                        if (multipleCheck == true) {
                            $.ajax({
                                url: '/Employee/MultipleServiceOrders',
                                type: "POST",
                                dataType: 'json',

                                data: { FormData: JSON.stringify(MultipleArrayValues), ExpenseDate: expenditureDate, ClientName: ClientName,
                                    From: FromLocation, To: ToLocation, ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                                    ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance, Localization: Localization,
                                    ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments
                                },
                                success: function (data) {
                                    $('#txtHeaderID').val(data);
                                    ExpenditureHeaderID = data;
                                    //closing
                                    $.ajax({
                                        url: '/Employee/ExpenditureListClose',
                                        type: "POST",
                                        cache: false,
                                        data: { HeaderID: data, FromStatus: FromStatus },
                                        success: function (data) {
                                            if (FromStatus == true) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Submitted Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            else if (FromStatus == false) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Saved Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            ClearOutStationFields();
                                            $('#txtHeaderID').val('');
                                            $('#txtOutstationDate').datepicker("update");
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                        else {
                            $.ajax({
                                url: '/Employee/LocalExpenditure',
                                type: "POST",
                                cache: false,
                                data: { ExpenseDate: expenditureDate, ClientName: ClientName, ServiceOrderNumber: SONo,
                                    OrderConfirmationNo: OrderConfirmationNo,
                                    From: FromLocation, To: ToLocation,
                                    ExpenditureType: ExpenditureType, kms: Kms, amount: Amount,
                                    SOExplanation: SOExplanation, ExpenditureTypeDetail: ExpenditureTypeDetail, Conveyance: Conveyance,
                                    Localization: Localization, ExpenditureHeaderID: ExpenditureHeaderID, ClientManagerName: ClientManagerName, ReasonForOther: Reason, Comments: comments, Mobile: Mobile, MobileTypeID: MobileID, Internet: Internet, InternetID: InternetID, SerialNoInstrument: SONoInstruments, OrderConfirmationDate: OrderConfirmationDate, MobileNo: MobileNo, MobileComment: MobileComment, InternetNo: InternetNo, InternetComment: InternetComment
                                },
                                dataType: 'json',
                                success: function (data) {
                                    $('#txtHeaderID').val(data);
                                    ExpenditureHeaderID = data;
                                    //closing
                                    $.ajax({
                                        url: '/Employee/ExpenditureListClose',
                                        type: "POST",
                                        cache: false,
                                        data: { HeaderID: data, FromStatus: FromStatus },
                                        success: function (data) {
                                            if (FromStatus == true) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Submitted Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            else if (FromStatus == false) {
                                                $(".popuppositionsucess").fadeIn();
                                                $('#sucessresult').text('Your Expenditure Saved Successfully');
                                                $('#sucessresult').show();
                                                $('.popuppositionsucess').delay(3000).fadeOut('slow');
                                            }
                                            ClearOutStationFields();
                                            $('#txtHeaderID').val('');
                                            $('#txtOutstationDate').datepicker("update");
                                        },
                                        error: function (event, jqxhr, settings, exception) {
                                            alert(exception);
                                        }
                                    });
                                },
                                error: function (event, jqxhr, settings, exception) {
                                    alert(exception);
                                }
                            });
                        }
                    }
                },
                error: function (event, jqxhr, settings, exception) {
                    alert(exception);
                }
            });
        }
    });
    $('#txtKms,#txtAmount,#txtOutAmount,#txtMobileBill,#txtInternetBill').keypress(function (e) {
        if (this.value.length == 0 && e.which == 48) {
            return false;
        }
    });

</script>
</form>